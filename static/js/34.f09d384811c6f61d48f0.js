webpackJsonp([34],{"7xJQ":function(e,t){},Uha8:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("fZjL"),l=a.n(i),r=a("BO1k"),s=a.n(r),o=a("mvHQ"),n=a.n(o),c=a("ifoU"),u=a.n(c),d=a("Vhou"),h={name:"AccountInfoThermal",props:{orgTree:Object},destroyed:function(){d.a.$off("globalMsgForThermalUser")},data:function(){var e=function(e,t,a){0===t.trim().length?a(new Error("登录标识不可为空")):a()};return{clmShow:!1,ballShow:!1,showTree:!0,menuLeft:"-180",menuLeft2:"80",menuWidth:"80px",floatDivWidth:70,floatRightValue:"50px",floatTopValue:"55px",ballIcon:"el-icon-more",cardBodyHeight:!0,cardBodyStyle:"padding-top:10px;padding-bottom:10px;",icon1:"el-icon-d-arrow-left",icon2:"el-icon-caret-top",tableSize:19,pictLoading:"pictLoading",tableData:[],tableTreeData:[],tableDataClone:[],multipleSelection:[],sortOrderCol:"",loginName:"",isCheckChild:!0,queryOrgType:"",userOrgIds:{},checkOrgTreeId:"",checkOrgTreeType:"",companyIds:[],childCompanyIds:[],instituteIds:[],stationIds:[],realNameByOrg:"",loginIdByOrg:"",checkOrgId:[],checkAllOrgIds:[],userQueryOrgIds:[],treeDataStatus:{},treeData:[],userOrgAngType:[],tableRowIdMap:new u.a,tableCheckedKeys:!1,permissionType:"all",menuNum:0,tableBtnRowIdMap:new u.a,tableBtnCheckedKeys:!1,userQueryBtnIds:{},btnNum:0,treeBtnData:[],tableBtnTreeData:[],tableBtnDataClone:[],passwdShow:!0,isCheck:!1,reLoad:"",treeDateForCheck:[],roleSelect:[],roleId:"",tableDialgTitle:"",tableOperFlag:"",refreshTableData:(new Date).getTime(),adminStatus:!0,submitColm:!1,thermalUserForm:{cui_uuid:"",cui_type:"",cui_login_id:"",cui_password:"123456",cui_realname:"",cui_wx_open_id:"",cui_wx_union_id:"",cui_wx_nick_name:"",cui_concat_phone:"",cui_status:!0,cui_admin_type:!1,cui_company_id:"",cui_child_company_id:"",cui_institute_id:"",cui_station_id:"",cui_org_type:"",update_org_type:""},permissionFormRules:{cui_login_id:[{validator:e,trigger:"blur"}],cui_realname:[{validator:e,trigger:"blur"}],cui_password:[],cui_concat_phone:[]},thermalUserFormVisible:!1,thermalUserOrgVisible:!1,thermalUserBtnVisible:!1,queryParam:{totalRow:0,currentPage:1,pageSize:this.customGlobal.pageSize},platUserSearchForm:{cui_realname:"",cui_login_id:"",cui_wx_nick_name:"",cui_concat_phone:""},rules:{}}},mounted:function(){var e=this;d.a.$on("globalMsgForThermalUser",function(t){e.isCheck=!0,e.checkOrgTreeId=t.cur_obj.orgid,e.checkOrgTreeType=t.cur_obj.type,e.userOrgIds={},e.thermalUserForm.cui_company_id="",e.thermalUserForm.cui_child_company_id="",e.thermalUserForm.cui_institute_id="",e.thermalUserForm.cui_station_id="";for(var a=0;a<t.obj.length;a++)switch(t.obj[a].type){case"1":e.thermalUserForm.cui_company_id=t.obj[a].id;break;case"2":e.thermalUserForm.cui_child_company_id=t.obj[a].id;break;case"3":e.thermalUserForm.cui_institute_id=t.obj[a].id;break;case"4":e.thermalUserForm.cui_station_id=t.obj[a].id}for(var i=0;i<t.obj.length;i++)e.userOrgIds[t.obj[i].id]=!0;e.queryValveCurrentData()})},created:function(){this.initAccOrgTreeData(this.customGlobal.userOrgan,this.customGlobal.permissionKeyOrganKey.orgkey);var e=this.customGlobal.userInfoExt;this.loginName=e.cui_login_id,"0"!==e.cui_admin_type&&"0"!==e.cui_type||(this.adminStatus=!1,this.submitColm=!0),"0"===e.cui_type?this.checkOrgTreeType=e.cui_org_type:this.checkOrgTreeType=e.cui_type,this.queryOrgType=this.checkOrgTreeType,this.queryValveCurrentData();var t=JSON.parse(n()(this.customGlobal.userMenu));this.initAccountTableTreeData(t),this.initAccountBtnTableTreeData(t)},directives:{trigger:{inserted:function(e,t){"ballBtn"===e.id&&e.click()}},drag:function(e){var t=e,a="";document.onselectstart=function(){return!1},t.onmousedown=function(e){var i=e.clientX-t.offsetLeft,l=e.clientY-t.offsetTop;return document.getElementById("dragbtn").setAttribute("data-flag",!1),document.getElementById("dragbtn").setAttribute("show2",t.offsetLeft),a=(new Date).getTime(),document.onmousemove=function(e){var a=e.clientX-i,r=e.clientY-l;a<=0?a=0:a>=document.documentElement.clientWidth-t.clientWidth&&(a=document.documentElement.clientWidth-t.clientWidth),document.getElementById("dragbtn").setAttribute("show2",a.toString()),r<=0?r=0:r>=document.documentElement.clientHeight-t.clientHeight&&(r=document.documentElement.clientHeight-t.clientHeight),t.style.left=a+"px",t.style.top=r+"px"},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null,(new Date).getTime()-a<200&&document.getElementById("dragbtn").setAttribute("data-flag",!0)},!1}}},methods:{confCardBodyHeigth:function(){!1===this.cardBodyHeight?(this.cardBodyHeight=!0,this.cardBodyStyle="padding-top:10px;padding-bottom:10px;",this.icon2="el-icon-caret-top"):(this.cardBodyHeight=!1,this.cardBodyStyle="padding-top:0px;padding-bottom:0px;",this.icon2="el-icon-caret-bottom")},sortColumn:function(e){var t="";null!=e.order?("descending"===e.order?t="desc":"ascending"===e.order&&(t="asc"),this.sortOrderCol=e.prop+" "+t,this.queryValveCurrentData()):this.sortOrderCol=""},handleSizeChange:function(e){this.queryParam.pageSize=e,this.queryValveCurrentData()},handleCurrentChange:function(e){this.queryParam.currentPage=e,this.queryValveCurrentData()},handleSelectionChange:function(e){this.multipleSelection=e},isSelect:function(e,t){return e.cui_login_id!=this.loginName},getRowKeys:function(e){return e.cui_login_id},openBox:function(){if(1!=document.getElementById("dragbtn").getAttribute("data-flag")){"el-icon-more"===this.ballIcon?this.ballIcon="el-icon-right":this.ballIcon="el-icon-more";var e=this.$refs.ballBtn.$el.getBoundingClientRect().x,t=document.documentElement.clientWidth;this.ballShow=!this.ballShow,document.getElementById("buttonThermalRole").style.left=e>t/2?this.menuLeft+"px":Math.abs(this.menuLeft2)+"px"}},closeDialog:function(){this.reLoad=this.thermalUserForm.cui_login_id,this.thermalUserFormVisible=!1,this.$refs.thermalUserForm.clearValidate()},getPermiessionId:function(e){var t=this,a={role_id:e},i=this;this.customGlobal.postHttpClient(this.customGlobal.serverUrl.platformRole_queryRoleByIds,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:n()(a)})).then(function(e){if("success"==e.data.status){var a=e.data.rows,l={};if(a.length>0){for(var r in a)t.tableRowIdMap.set(a[r].rp_p_id,!0),l[a[r].rp_p_id]=!0;t.menuNum=a.length}t.noCheckTreeTable(i.tableTreeData),t.initTableDataPermissionStatus(l,i.tableTreeData)}else i.tableTreeData=[],t.$alert(e.data.msg,"查询失败",{confirmButtonText:"确定",callback:function(a){"请登录认证"===e.data.msg&&"failed"===e.data.status&&t.$router.replace({path:"/login"})}})},function(e){i.tableTreeData=[],t.$alert(n()(e.message),"查询出错!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(e){i.tableTreeData=[],t.$alert(n()(e.message),"查询出错",{confirmButtonText:"确定",callback:function(e){}})})},reQueryValveCurrentData:function(){this.queryParam.currentPage=1,this.queryValveCurrentData()},queryValveCurrentData:function(){var e=this,t=this.companyIds,a=this.childCompanyIds,i=this.instituteIds,l=this.stationIds;if(this.queryOrgType>this.checkOrgTreeType)this.$alert("您还未获取此机构的查询权限，请联系系统管理员！","查询出错!",{confirmButtonText:"确定",callback:function(e){}});else{var r=this,s={perPageSize:this.queryParam.pageSize,currentPage:this.queryParam.currentPage,cui_login_id:this.platUserSearchForm.cui_login_id,cui_realname:this.platUserSearchForm.cui_realname,cui_wx_nick_name:this.platUserSearchForm.cui_wx_nick_name,cui_concat_phone:this.platUserSearchForm.cui_concat_phone,cui_status:this.platUserSearchForm.cui_status,check_org_id:this.checkOrgTreeId,check_org_type:this.checkOrgTreeType,is_check_child:this.isCheckChild,login_name:this.loginName,cui_type:this.customGlobal.userInfoExt.cui_type,is_check:this.isCheck,query_company:t,query_child:a,query_institute:i,query_station:l};""!==this.sortOrderCol?s.orderby=this.sortOrderCol:s.orderby=" cui_writetime desc ";var o=this.$loading({lock:!0,text:"查询中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, .7)"});this.customGlobal.postHttpClient(this.customGlobal.serverUrl.thermalAccount_query,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:n()(s)})).then(function(t){"success"==t.data.status?(o.close(),r.tableData=t.data.rows,r.queryParam.totalRow=t.data.total):(o.close(),r.tableData=[],e.$alert(t.data.msg,"查询失败",{confirmButtonText:"确定",callback:function(a){"请登录认证"===t.data.msg&&"failed"===t.data.status&&e.$router.replace({path:"/login"})}}))},function(t){o.close(),r.tableData=[],e.$alert(n()(t.message),"查询出错!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(t){o.close(),r.tableData=[],e.$alert(n()(t.message),"查询出错",{confirmButtonText:"确定",callback:function(e){}})})}},accountUserAdd:function(){var e=this;"{}"!=n()(this.userOrgIds)?this.queryOrgType>this.checkOrgTreeType?this.$alert("您不是此机构下的人员，无权新增用户！","系统提示!",{confirmButtonText:"确定",callback:function(e){}}):(0==this.roleSelect.length&&this.getAccountRole(),""!=this.reLoad&&this.$nextTick(function(){e.noCheckTreeTable(e.tableTreeData),e.initTableDataPermissionStatus("{}",e.tableTreeData)}),this.passwdShow=!0,this.thermalUserFormVisible=!0,this.tableDialgTitle="新增热力用户及菜单授权",this.tableOperFlag=1,this.menuNum=0,this.thermalUserForm.cui_login_id="",this.thermalUserForm.cui_password="123456",this.thermalUserForm.cui_realname="",this.thermalUserForm.cui_wx_nick_name="",this.thermalUserForm.cui_concat_phone="",this.thermalUserForm.cui_wx_open_id="",this.thermalUserForm.cui_uuid="",this.thermalUserForm.cui_status=!0,this.thermalUserForm.cui_admin_type=!1):this.$alert("请为新增的用户选择一个机构！","系统提示!",{confirmButtonText:"确定",callback:function(e){}})},accountUserEdit:function(e){this.passwdShow=!1,this.tableRowIdMap=new u.a,this.thermalUserFormVisible=!0,this.tableDialgTitle="编辑热力用户及菜单授权",this.tableOperFlag=2,this.thermalUserForm.cui_login_id=e.cui_login_id,this.thermalUserForm.cui_realname=e.cui_realname,this.thermalUserForm.cui_wx_nick_name=e.cui_wx_nick_name,this.thermalUserForm.cui_concat_phone=e.cui_concat_phone,this.thermalUserForm.cui_wx_open_id=e.cui_wx_open_id,this.thermalUserForm.cui_wx_union_id=e.cui_wx_union_id,this.thermalUserForm.cui_uuid=e.cui_uuid,this.thermalUserForm.cui_status=1==e.cui_status,this.thermalUserForm.cui_admin_type=0==e.cui_admin_type,this.thermalUserForm.update_org_type=e.cui_type,this.thermalUserForm.cui_company_id=e.cui_company_id,this.thermalUserForm.cui_child_company_id=e.cui_child_company_id,this.thermalUserForm.cui_institute_id=e.cui_institute_id,this.thermalUserForm.cui_station_id=e.cui_station_id,this.reLoad!=e.cui_login_id&&this.queryUserRoleIds(e.cui_login_id),this.getAccountRole()},accountUserDel:function(e){var t=this;this.tableOperFlag=3,this.$confirm('请再次确认是否要删除用户[<span style="color:red;">'+e.cui_realname+"</span>]的记录?","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0,closeOnClickModal:!1,closeOnPressEscape:!1}).then(function(){var a={uid:e.cui_uuid,login_id:e.cui_login_id},i=t.$loading({lock:!0,text:"操作中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, .7)"});t.customGlobal.postHttpClient(t.customGlobal.serverUrl.platformAccount_delete,t.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},t.qs.stringify({jsondata:n()(a)})).then(function(e){"success"==e.data.status?(t.reQueryValveCurrentData(),i.close(),t.$message({type:"success",message:"删除成功!"})):(i.close(),t.$alert(e.data.msg,"查询失败",{confirmButtonText:"确定",callback:function(a){"请登录认证"===e.data.msg&&"failed"===e.data.status&&t.$router.replace({path:"/login"})}}))},function(e){i.close(),t.$alert(n()(e.message),"删除出错!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(e){i.close(),t.$alert(n()(e.message),"删除出错",{confirmButtonText:"确定",callback:function(e){}})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},resetForm:function(e){var t=this;this.$nextTick(function(){t.$refs[e].resetFields()})},submitForm:function(e){var t=this,a="",i="",l=this.tableOperFlag;if(this.queryOrgType>this.checkOrgTreeType)this.$alert("您还未获取此机构的操作权限，请联系系统管理员！","新增出错!",{confirmButtonText:"确定",callback:function(e){}});else{switch(l){case 1:a=this.customGlobal.serverUrl.thermalAccount_add,i="添加";break;case 2:a=this.customGlobal.serverUrl.thermalAccount_update,i="编辑"}var r={};this.tableRowIdMap.forEach(function(e,t){r[t]=!0}),this.$refs[e].validate(function(e){if(!e)return!1;var l={cui_uuid:t.thermalUserForm.cui_uuid,cui_login_id:t.thermalUserForm.cui_login_id,cui_password:t.customGlobal.md5(t.thermalUserForm.cui_password),cui_realname:t.thermalUserForm.cui_realname,cui_wx_nick_name:t.thermalUserForm.cui_wx_nick_name,cui_concat_phone:t.thermalUserForm.cui_concat_phone,cui_wx_open_id:t.thermalUserForm.cui_wx_open_id,cui_wx_union_id:t.thermalUserForm.cui_wx_union_id,cui_status:1==t.thermalUserForm.cui_status?"1":"2",check_org_id:t.checkOrgTreeId,check_org_type:t.checkOrgTreeType,cui_company_id:t.thermalUserForm.cui_company_id,cui_child_company_id:t.thermalUserForm.cui_child_company_id,cui_institute_id:t.thermalUserForm.cui_institute_id,cui_station_id:t.thermalUserForm.cui_station_id,cui_admin_type:1==t.thermalUserForm.cui_admin_type?"0":"1",permission_id:r,org_id:t.userOrgIds,update_org_type:t.thermalUserForm.update_org_type},s=t.$loading({lock:!0,text:"提交中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, .7)"});t.customGlobal.postHttpClient(a,t.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},t.qs.stringify({jsondata:n()(l)})).then(function(e){"success"==e.data.status?(t.thermalUserFormVisible=!1,t.tableRowIdMap=new u.a,t.noCheckTreeTable(t.tableTreeData),t.queryValveCurrentData(),s.close(),t.$message({type:"success",message:i+"成功!"})):(s.close(),t.$alert(e.data.msg,i+"失败",{confirmButtonText:"确定",callback:function(a){"请登录认证"===e.data.msg&&"failed"===e.data.status&&t.$router.replace({path:"/login"})}}))},function(e){s.close()}).catch(function(e){s.close()})})}},isCellPhone:function(e){return!!/^1(3|4|5|6|7|8)\d{9}$/.test(e)},getAccountRole:function(){var e=this;this.customGlobal.postHttpClient(this.customGlobal.serverUrl.platformRole_queryAll,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:n()({r_type:2})})).then(function(t){"success"==t.data.status&&(e.roleSelect=t.data.rows)},function(e){}).catch(function(e){})},saveUserPermission:function(e,t){var a=this,i={username:e,permissionkey:t};this.customGlobal.postHttpClient(this.customGlobal.serverUrl.postCreateUserAndPermissionKey,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:n()(i)})).then(function(e){"success"==e.data.status||a.$alert("请联系系统管理员，并提交错误报告："+n()(error.message),"保存用户菜单权限出错!",{confirmButtonText:"确定",callback:function(e){}})},function(e){a.$alert(n()(e.message),"保存用户菜单权限出错!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(e){a.$alert(n()(e.message),"保存用户菜单权限出错",{confirmButtonText:"确定",callback:function(e){}})})},queryUserRoleIds:function(e){var t=this,a={username:e};this.customGlobal.postHttpClient(this.customGlobal.serverUrl.postQueryUserOrgAndPermissionKey,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:n()(a)})).then(function(e){if("success"==e.data.status){t.tableRowIdMap=new u.a,t.userQueryRoleIds={};var a=JSON.parse(e.data.permissionkey);t.userQueryRoleIds=a;var i=0,r=!0,o=!1,n=void 0;try{for(var c,d=s()(l()(a));!(r=(c=d.next()).done);r=!0){var h=c.value;"-1"!==h&&(t.tableRowIdMap.set(h,!0),i++)}}catch(e){o=!0,n=e}finally{try{!r&&d.return&&d.return()}finally{if(o)throw n}}t.menuNum=i,t.noCheckTreeTable(t.tableTreeData),t.initTableDataPermissionStatus(t.userQueryRoleIds,t.tableTreeData)}},function(e){t.$alert(n()(e.message),"权限查询出错!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(e){t.$alert(n()(e.message),"权限查询查询出错",{confirmButtonText:"确定",callback:function(e){}})})},queryUserOrgIds:function(e){var t=this,a={username:e};this.customGlobal.postHttpClient(this.customGlobal.serverUrl.postQueryUserOrgAndPermissionKey,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:n()(a)})).then(function(e){if(t.userQueryOrgIds=[],"success"==e.data.status){var a=JSON.parse(e.data.orgkey),i=0,r=!0,o=!1,n=void 0;try{for(var c,u=s()(l()(a));!(r=(c=u.next()).done);r=!0){var d=c.value;t.userQueryOrgIds[i]=d,i++}}catch(e){o=!0,n=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw n}}t.$refs.thermalOrgTree.setCheckedKeys(t.userQueryOrgIds,!0)}},function(e){t.$alert(n()(e.message),"机构查询出错!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(e){t.$alert(n()(e.message),"机构查询查询出错",{confirmButtonText:"确定",callback:function(e){}})})},delPlatformUserArray:function(){var e=this;if(0!=this.multipleSelection.length){for(var t=[],a=0;a<this.multipleSelection.length;a++)t[a]=this.multipleSelection[a].cui_login_id;this.$confirm('请再次确认是否要对已选中的[<span style="color:red;">'+t.length+"</span>]个用户信息进行删除?","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0,closeOnClickModal:!1,closeOnPressEscape:!1}).then(function(){var a={login_id:t},i=e.$loading({lock:!0,text:"操作中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, .7)"});e.customGlobal.postHttpClient(e.customGlobal.serverUrl.delUserByArray,e.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},e.qs.stringify({jsondata:n()(a)})).then(function(t){i.close(),"success"==t.data.status?(e.reQueryValveCurrentData(),e.$refs.thermalUserTable.clearSelection(),e.$message({type:"success",message:"删除成功!"})):(i.close(),e.$alert(t.data.msg,"批量删除失败",{confirmButtonText:"确定",callback:function(a){"请登录认证"===t.data.msg&&"failed"===t.data.status&&e.$router.replace({path:"/login"})}}))},function(t){i.close(),e.$alert(n()(t.message),"批量删除出错!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(t){i.close(),e.$alert(n()(t.message),"批量删除出错",{confirmButtonText:"确定",callback:function(e){}})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}else this.$alert("您还未选择用户，无法进行删除！","提示信息",{confirmButtonText:"确定",callback:function(e){}})},resetUserPasswd:function(e){var t=this;this.$confirm('请再次确认是否要将用户[<span style="color:red;">'+e.cui_realname+"</span>]的密码进行初始化？","操作提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0,closeOnClickModal:!1,closeOnPressEscape:!1}).then(function(){var a={login_id:e.cui_login_id,pass_word:t.customGlobal.md5("123456")},i=t.$loading({lock:!0,text:"操作中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, .7)"});t.customGlobal.postHttpClient(t.customGlobal.serverUrl.resetUserPasswd,t.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},t.qs.stringify({jsondata:n()(a)})).then(function(e){i.close(),"success"==e.data.status?t.$message({type:"success",message:"重置密码成功!"}):(i.close(),t.$alert(e.data.msg,"重置密码失败",{confirmButtonText:"确定",callback:function(a){"请登录认证"===e.data.msg&&"failed"===e.data.status&&t.$router.replace({path:"/login"})}}))},function(e){i.close(),t.$alert(n()(e.message),"重置密码出错!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(e){i.close(),t.$alert(n()(e.message),"重置密码出错",{confirmButtonText:"确定",callback:function(e){}})})}).catch(function(){t.$message({type:"info",message:"已取消"})})},tableTreeSelectAll:function(){this.tableCheckedKeys=!this.tableCheckedKeys,this.spliteTable(this.tableTreeData,this.tableCheckedKeys);var e=this.$refs.thermalRoleTreeTable.selection;if(0===e.length)this.tableRowIdMap.clear();else for(var t=0;t<e.length;t++)this.tableRowIdMap.set(e[t].id,!0);this.menuNum=this.tableRowIdMap.size},spliteTable:function(e,t){for(var a=0;a<e.length;a++)this.$refs.thermalRoleTreeTable.toggleRowSelection(e[a],t),e[a].status=t,!1===this.tableRowIdMap.has(e[a].id)?this.tableRowIdMap.set(e[a].id,!0):!0===this.tableRowIdMap.get(e[a].id)?this.tableRowIdMap.delete(e[a].id):this.tableRowIdMap.set(e[a].id,!0,e[a].caption),e[a].detail&&this.spliteTable(e[a].detail,t)},tableTreeSingleSelect:function(e,t){!1===this.tableRowIdMap.has(t.id)?this.tableRowIdMap.set(t.id,!0):!0===this.tableRowIdMap.get(t.id)?this.tableRowIdMap.delete(t.id):this.tableRowIdMap.set(t.id,!0),t.detail&&this.spliteTable(t.detail)},handleSelectTreeCurrent:function(e){"false"===e.status?e.status="true":"true"===e.status&&(e.status="false"),void 0!=e.detail&&this.spliteTable(e.detail),this.$refs.thermalRoleTreeTable.toggleRowSelection(e),!1===this.tableRowIdMap.has(e.id)?this.tableRowIdMap.set(e.id,!0):!0===this.tableRowIdMap.get(e.id)?this.tableRowIdMap.delete(e.id):this.tableRowIdMap.set(e.id,!0)},initAccountTableTreeData:function(e){"all"===this.permissionType?this.tableTreeData=[{caption:"热力用户权限",id:"00-0",detail:this.initAccTreeData(e.heatconfig.permissionconfig.detail)}]:this.tableTreeData=this.initAccTreeData(e.permissionconfig.detail),this.tableDataClone=this.tableTreeData},tableTreeSelectChange:function(e){this.menuNum=this.tableRowIdMap.size},initLoopCheckTable:function(e){for(var t=0;t<e.length;t++)"false"===e[t].status?(this.tableRowIdMap.delete(e[t].id),this.$refs.thermalRoleTreeTable.toggleRowSelection(e[t],!1)):"true"===e[t].status&&(this.tableRowIdMap.set(e[t].id,!0),this.$refs.thermalRoleTreeTable.toggleRowSelection(e[t],!0)),e[t].detail&&this.initLoopCheckTable(e[t].detail)},initAccTreeData:function(e){for(var t=0;t<e.length;t++)e[t].detail&&this.initAccTreeData(e[t].detail),"false"===e[t].status&&(e.splice(t,1),t--);return e},noCheckTreeTable:function(e){this.tableRowIdMap=new u.a;for(var t=0;t<e.length;t++)this.$refs.thermalRoleTreeTable.toggleRowSelection(e[t],!1),e[t].status=!1,e[t].detail&&this.noCheckTreeTable(e[t].detail)},checkPermissionId:function(e,t,a,i,l){for(var r=!1,s=0;s<t.length;s++)if("1"===l)if(t[s].id===e){if("1"===i){t.push(a),this.tableDataClone=this.tableData,r=!0;break}if("2"===i){if(t[s].hasOwnProperty("detail")){var o=t[s].detail;o.push(a),t[s].detail=o,this.tableDataClone=this.tableData,r=!0;break}var n=[];n.push(a),t[s].detail=n,this.tableDataClone=this.tableData,r=!0;break}}else if(t[s].hasOwnProperty("detail")){if(!0===(r=this.checkPermissionId(e,t[s].detail,a,i,l)))break}else r=!1;else if("2"===l){if(t[s].id===e){t[s].caption=a.caption,t[s].vue=a.vue,t[s].url=a.url,t[s].icon=a.icon,this.tableDataClone=this.tableData,r=!0;break}if(t[s].hasOwnProperty("detail")){if(!0===(r=this.checkPermissionId(e,t[s].detail,a,i,l)))break}else r=!1}else if("3"===l){if(t[s].id===e){t.splice(s,1),this.tableDataClone=this.tableData,r=!0;break}if(t[s].hasOwnProperty("detail")){if(!0===(r=this.checkPermissionId(e,t[s].detail,a,i,l)))break}else r=!1}else if("4"===l){if(t[s].caption.toLowerCase().indexOf(e.toLowerCase())>-1){var c=[];c.push(t[s]),this.tableDataClone=c,r=!0;break}if(t[s].hasOwnProperty("detail")){if(!0===(r=this.checkPermissionId(e,t[s].detail,a,i,l)))break}else this.tableDataClone=[],r=!1}else if("5"===l){if(t[s].id===e){t[s].status="true",this.tableDataClone=this.tableData,r=!0;break}if(t[s].hasOwnProperty("detail")){if(!0===(r=this.checkPermissionId(e,t[s].detail,a,i,l)))break}else this.tableDataClone=[],r=!1}return r},checkedTreeTable:function(e){var t=this;this.$nextTick(function(){t.tableTreeData.forEach(function(a){""!=a.detail&&a.detail.forEach(function(a){for(var i=0;i<e.length;i++)a.id===e[i]&&t.$refs.thermalRoleTreeTable.toggleRowSelection(a,!0);""!=a.detail&&a.detail.forEach(function(a){for(var i=0;i<e.length;i++)a.id===e[i]&&t.$refs.thermalRoleTreeTable.toggleRowSelection(a,!0)})})})})},initTableDataPermissionStatus:function(e,t){var a=this,i=!0,r=!1,o=void 0;try{for(var n,c=s()(l()(e));!(i=(n=c.next()).done);i=!0){var u=n.value;this.checkPermissionId(u,t,{},"0","5")}}catch(e){r=!0,o=e}finally{try{!i&&c.return&&c.return()}finally{if(r)throw o}}this.$nextTick(function(){a.initLoopCheckTable(t)})},platformUserBtn:function(e){this.thermalUserBtnVisible=!0,this.loginIdByOrg=e.cui_login_id,this.realNameByOrg=e.cui_realname,0==this.roleSelect.length&&this.getPlatformUserBtn(e.cui_login_id)},tableBtnTreeSelectAll:function(){this.tableBtnCheckedKeys=!this.tableBtnCheckedKeys,this.spliteBtnTable(this.tableBtnTreeData,this.tableBtnCheckedKeys);var e=this.$refs.platBtnTreeTable.selection;if(0===e.length)this.tableBtnRowIdMap.clear();else for(var t=0;t<e.length;t++)this.tableBtnRowIdMap.set(e[t].id,!0);this.btnNum=this.tableBtnRowIdMap.size},spliteBtnTable:function(e,t){for(var a=0;a<e.length;a++)this.$refs.platBtnTreeTable.toggleRowSelection(e[a],t),e[a].status=t,!1===this.tableBtnRowIdMap.has(e[a].id)?this.tableBtnRowIdMap.set(e[a].id,!0):!0===this.tableBtnRowIdMap.get(e[a].id)?this.tableBtnRowIdMap.delete(e[a].id):this.tableBtnRowIdMap.set(e[a].id,!0,e[a].caption),e[a].detail&&this.spliteBtnTable(e[a].detail,t)},tableBtnTreeSingleSelect:function(e,t){!1===this.tableBtnRowIdMap.has(t.id)?this.tableBtnRowIdMap.set(t.id,!0):!0===this.tableBtnRowIdMap.get(t.id)?this.tableBtnRowIdMap.delete(t.id):this.tableBtnRowIdMap.set(t.id,!0),t.detail&&this.spliteBtnTable(t.detail)},initAccountBtnTableTreeData:function(e){if("all"===this.permissionType){var t={};t="0"===this.customGlobal.userInfoExt.cui_org_type?e.heatconfig.buttonconfig.detail:this.initAccBtnTreeData(e.heatconfig.buttonconfig.detail),this.tableBtnTreeData=[{caption:"热力用户按钮权限",vue:"",url:"",icon:"",id:"00-4",detail:t}]}else this.tableBtnTreeData=this.initAccBtnTreeData(e.heatconfig.detail);this.tableBtnDataClone=this.tableBtnTreeData},initAccBtnTreeData:function(e){for(var t=0;t<e.length;t++)e[t].detail&&this.initAccBtnTreeData(e[t].detail),"false"===e[t].status&&(e.splice(t,1),t--);return e},tableBtnTreeSelectChange:function(e){this.btnNum=this.tableBtnRowIdMap.size},initBtnLoopCheckTable:function(e){for(var t=0;t<e.length;t++)"false"===e[t].status?(this.tableBtnRowIdMap.delete(e[t].id),this.$refs.platBtnTreeTable.toggleRowSelection(e[t],!1)):"true"===e[t].status&&(this.tableBtnRowIdMap.set(e[t].id,!0),this.$refs.platBtnTreeTable.toggleRowSelection(e[t],!0)),e[t].detail&&this.initBtnLoopCheckTable(e[t].detail)},noCheckBtnTreeTable:function(e){this.tableBtnRowIdMap=new u.a;for(var t=0;t<e.length;t++)this.$refs.platBtnTreeTable.toggleRowSelection(e[t],!1),e[t].status=!1,e[t].detail&&this.noCheckBtnTreeTable(e[t].detail)},checkBtnPermissionId:function(e,t,a,i,l){for(var r=!1,s=0;s<t.length;s++)if("5"===l){if(t[s].id===e){t[s].status="true",this.tableDataClone=this.tableData,r=!0;break}if(t[s].hasOwnProperty("detail")){if(!0===(r=this.checkPermissionId(e,t[s].detail,a,i,l)))break}else this.tableDataClone=[],r=!1}return r},initBtnTableDataPermissionStatus:function(e,t){var a=this,i=!0,r=!1,o=void 0;try{for(var n,c=s()(l()(e));!(i=(n=c.next()).done);i=!0){var u=n.value;this.checkPermissionId(u,t,{},"0","5")}}catch(e){r=!0,o=e}finally{try{!i&&c.return&&c.return()}finally{if(r)throw o}}this.$nextTick(function(){a.initBtnLoopCheckTable(t)})},getPlatformUserBtn:function(e){var t=this,a={username:e};this.customGlobal.postHttpClient(this.customGlobal.serverUrl.postQueryUserOrgAndPermissionKey,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:n()(a)})).then(function(e){if("success"==e.data.status){t.tableBtnRowIdMap=new u.a,t.userQueryBtnIds={};var a=JSON.parse(e.data.btnkey);t.userQueryBtnIds=a;var i=0,r=!0,o=!1,n=void 0;try{for(var c,d=s()(l()(a));!(r=(c=d.next()).done);r=!0){var h=c.value;"-1"!==h&&(t.tableBtnRowIdMap.set(h,!0),i++)}}catch(e){o=!0,n=e}finally{try{!r&&d.return&&d.return()}finally{if(o)throw n}}t.btnNum=i,t.noCheckBtnTreeTable(t.tableTreeData),t.initBtnTableDataPermissionStatus(t.userQueryBtnIds,t.tableBtnTreeData)}},function(e){t.$alert(n()(e.message),"按钮权限查询出错!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(e){t.$alert(n()(e.message),"按钮权限查询查询出错",{confirmButtonText:"确定",callback:function(e){}})})},submitUserBtn:function(){var e=this,t={};this.tableBtnRowIdMap.forEach(function(e,a){t[a]=!1}),"{}"===n()(t)&&(t[-1]=!1);var a={username:this.loginIdByOrg,btnkey:t},i=this.$loading({lock:!0,text:"提交中...",target:".main",spinner:"el-icon-loading",background:"rgba(0,0,0,0.7)"});this.customGlobal.postHttpClient(this.customGlobal.serverUrl.postModifyUserAndBtnKey,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:n()(a)})).then(function(t){e.queryValveCurrentData(),"success"==t.data.status?(e.thermalUserBtnVisible=!1,e.tableBtnRowIdMap=new u.a,e.noCheckBtnTreeTable(e.tableBtnTreeData),i.close(),e.$message({type:"success",message:"按钮权限保存成功!"})):(i.close(),e.$alert(t.data.msg,msg_show+"失败",{confirmButtonText:"确定",callback:function(a){"请登录认证"===t.data.msg&&"failed"===t.data.status&&e.$router.replace({path:"/login"})}}))},function(e){i.close()}).catch(function(e){i.close()})},showOrgTree:function(e){var t=this;this.treeData=JSON.parse(n()(this.orgTree.treeData)),this.treeDataStatus=JSON.parse(n()(this.orgTree.treeDataStatus)),this.initAccOrgTreeData(this.treeData,this.treeDataStatus),this.loginIdByOrg=e.cui_login_id,this.realNameByOrg=e.cui_realname,this.thermalUserOrgVisible=!0,this.checkAllOrgIds.length>0&&this.$nextTick(function(){t.noCheckOrgTree(t.checkAllOrgIds)}),this.checkOrgId=[],this.checkAllOrgIds=[],this.queryUserOrgIds(e.cui_login_id)},handleCheck:function(e,t){this.checkOrgId=t.checkedKeys,t.checkedNodes.length>0&&(this.selType=t.checkedNodes[t.checkedNodes.length-1].type),this.checkAllOrgIds=[],this.recursion(this.treeData,!1),this.checkAllOrgIds=this.checkAllOrgIds.reverse()},recursion:function(e,t){for(var a=[],i=0;i<e.length;i++){var l=e[i];a[i]=!1,l.detail&&(a[i]=!!this.recursion(l.detail,!0)||a[i],a[i]&&this.checkAllOrgIds.push(l.id));for(var r=0;r<this.checkOrgId.length;r++)if(l.id==this.checkOrgId[r]){a[i]=!0,-1==this.checkAllOrgIds.indexOf(l.id)&&this.checkAllOrgIds.push(l.id);break}}if(t)return-1!=a.indexOf(!0)},noCheckOrgTree:function(e){this.$refs.thermalOrgTree.setCheckedKeys(e)},removeTreeNode:function(e,t){var a=e.parent,i=a.data.detail||a.data,l=i.findIndex(function(e){return e.id===t.id});i.splice(l,1)},initTreeDataStatus:function(e,t){var a=t.node,i=t.data;t.store;if("{}"===n()(this.treeDataStatus))return e("span",{style:"font-size:14px;"},[e("span",[i.caption])]);var r=!1,o=!0,c=!1,u=void 0;try{for(var d,h=s()(l()(this.treeDataStatus));!(o=(d=h.next()).done);o=!0){var m=d.value;if(i.id===m)return e("span",{style:"font-size:14px;"},[e("span",[i.caption])])}}catch(e){c=!0,u=e}finally{try{!o&&h.return&&h.return()}finally{if(c)throw u}}!1===r&&this.removeTreeNode(a,i)},initAccOrgTreeData:function(e,t){if("0"!==this.customGlobal.userInfoExt.cui_type||"0"!==this.customGlobal.userInfoExt.cui_org_type){var a=!0,i=!1,r=void 0;try{for(var o,n=s()(l()(t));!(a=(o=n.next()).done);a=!0){var c=o.value;this.selectOrgIds(e,c)}}catch(e){i=!0,r=e}finally{try{!a&&n.return&&n.return()}finally{if(i)throw r}}}else this.selectAdminOrgIds(e)},selectOrgIds:function(e,t){for(var a=0;a<e.length;a++){if(e[a].id===t&&e[a].type>=this.customGlobal.userInfoExt.cui_type)switch(e[a].type){case 1:this.companyIds.push(e[a].id);break;case 2:this.childCompanyIds.push(e[a].id);break;case 3:this.instituteIds.push(e[a].id);break;case 4:this.stationIds.push(e[a].id)}e[a].detail&&this.selectOrgIds(e[a].detail,t)}},selectAdminOrgIds:function(e){for(var t=0;t<e.length;t++){switch(e[t].type){case 1:this.companyIds.push(e[t].id);break;case 2:this.childCompanyIds.push(e[t].id);break;case 3:this.instituteIds.push(e[t].id);break;case 4:this.stationIds.push(e[t].id)}e[t].detail&&this.selectAdminOrgIds(e[t].detail)}},initOrgTemplateInfo:function(){var e=this,t=this.$loading({lock:!0,text:"查询中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, .7)"});this.customGlobal.postHttpClient(this.customGlobal.serverUrl.postQueryOrganTemplate,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:n()({config:"all",username:this.customGlobal.userInfoExt.cui_login_id})})).then(function(a){"success"==a.data.status?(e.treeData=JSON.parse(a.data.organ).detail,e.treeDataStatus=JSON.parse(a.data.orgkey),t.close()):(e.treeData=[JSON.parse(a.data.organ)],e.treeDataStatus=JSON.parse(a.data.orgkey),t.close())},function(a){t.close(),e.$alert(n()(a.message),"保存出错!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(a){t.close(),e.$alert(n()(a.message),"保存出错",{confirmButtonText:"确定",callback:function(e){}})})},submitUserOrg:function(){var e=this;if(0!=this.checkAllOrgIds.length)if(this.selType<this.customGlobal.userInfoExt.cui_org_type)this.$alert("您还未取得此机构的权限！","保存热力用户机构信息",{confirmButtonText:"确定",callback:function(e){}});else{for(var t={},a=0;a<this.checkAllOrgIds.length;a++)t[this.checkAllOrgIds[a]]=!0;this.saveUserOrgKeys(this.loginIdByOrg,t),this.$nextTick(function(){e.$refs.thermalOrgTree.setCheckedKeys(e.checkAllOrgIds)}),this.userOrgId=[],this.platformUserOrgVisible=!1}else this.$alert("机构信息不能为空或您未做变更，无法提交！","保存热力用户机构信息",{confirmButtonText:"确定",callback:function(e){}})},saveUserOrgKeys:function(e,t){var a=this,i={username:e,orgkey:t},l=this.$loading({lock:!0,text:"操作中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, .7)"});this.customGlobal.postHttpClient(this.customGlobal.serverUrl.postCreateUserAndOrgKey,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:n()(i)})).then(function(e){a.thermalUserOrgVisible=!1,l.close(),"success"==e.data.status?a.$message({type:"success",message:"热力用户机构信息保存成功!"}):a.$alert("请联系系统管理员，并提交错误报告："+n()(error.message),"保存用户机构权限出错!",{confirmButtonText:"确定",callback:function(e){}})},function(e){l.close(),a.$alert(n()(e.message),"保存用户机构权限出错!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(e){l.close(),a.$alert(n()(e.message),"保存用户机构权限出错",{confirmButtonText:"确定",callback:function(e){}})})}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"ruleForm2",staticClass:"account-formitem",staticStyle:{"text-align":"left","font-size":"20px","font-weight":"bold",width:"100%"},attrs:{"label-position":"left",model:e.platUserSearchForm,rules:e.rules,"label-width":"130px"}},[a("el-card",{staticClass:"account-card1",attrs:{shadow:"always","body-style":e.cardBodyStyle}},[a("div",{staticStyle:{"font-size":"14px","font-weight":"bold"},attrs:{slot:"header"},on:{click:e.confCardBodyHeigth},slot:"header"},[a("el-row",{on:{click:e.confCardBodyHeigth}},[a("el-col",{attrs:{md:23}},[e._v("\n                  用户信息\n                ")]),e._v(" "),a("el-col",{attrs:{md:1},on:{click:e.confCardBodyHeigth}},[a("el-link",{staticStyle:{float:"right","text-decoration":"none","font-size":"20px",height:"10px","line-height":"10px"},attrs:{icon:e.icon2,underline:!1}})],1)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.cardBodyHeight,expression:"cardBodyHeight"}],staticStyle:{padding:"5px 20px 5px 20px"}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{md:8}},[a("el-form-item",{attrs:{label:"真实姓名",prop:"cui_realname"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.platUserSearchForm.cui_realname,callback:function(t){e.$set(e.platUserSearchForm,"cui_realname",t)},expression:"platUserSearchForm.cui_realname"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:8}},[a("el-form-item",{attrs:{label:"登录标识",prop:"cui_login_id"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.platUserSearchForm.cui_login_id,callback:function(t){e.$set(e.platUserSearchForm,"cui_login_id",t)},expression:"platUserSearchForm.cui_login_id"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:8}},[a("el-form-item",{attrs:{label:"联系电话",prop:"cui_concat_phone"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.platUserSearchForm.cui_concat_phone,callback:function(t){e.$set(e.platUserSearchForm,"cui_concat_phone",t)},expression:"platUserSearchForm.cui_concat_phone"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{md:8}},[a("el-form-item",{attrs:{label:"用户量级",prop:"用户量级"}},[a("el-checkbox",{model:{value:e.isCheckChild,callback:function(t){e.isCheckChild=t},expression:"isCheckChild"}},[e._v("包含下级")])],1)],1),e._v(" "),a("el-col",{attrs:{md:8}},[a("el-form-item",{attrs:{label:"用户状态",prop:"cui_status"}},[a("div",{staticClass:"select-p"},[a("el-select",{staticStyle:{width:"80%"},attrs:{placeholder:"请选择"},model:{value:e.platUserSearchForm.cui_status,callback:function(t){e.$set(e.platUserSearchForm,"cui_status",t)},expression:"platUserSearchForm.cui_status"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),a("el-option",{attrs:{label:"启用",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"禁用",value:"2"}})],1)],1)])],1),e._v(" "),a("el-col",{attrs:{md:8}},[a("el-button",{staticStyle:{float:"right","margin-right":"15%"},attrs:{type:"primary"},on:{click:e.queryValveCurrentData}},[e._v("查询")])],1)],1)],1)])],1),e._v(" "),a("el-card",{staticClass:"account-card1",staticStyle:{width:"100%",padding:"5px 20px 5px 20px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:this.submitColm,expression:"this.submitColm"}],staticStyle:{position:"relative"},attrs:{id:"dragbtn"}},[a("div",{directives:[{name:"drag",rawName:"v-drag"}],style:{width:"62px",right:this.floatRightValue,top:this.floatTopValue,"border-radius":"50%",position:"fixed","padding-left":"0px","padding-top":"8px",cursor:"pointer","z-index":"888"},attrs:{draggable:"false"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.ballShow,expression:"ballShow"}],style:{display:"flex","justify-content":"space-between",position:"absolute",left:this.menuLeft,width:this.menuWidth,top:" 10px"},attrs:{id:"buttonThermalRole"}},[a("div",{staticStyle:{float:"right","margin-right":"20px"}},[a("el-button",{attrs:{type:"danger",size:"small",title:"批量删除"},on:{click:e.delPlatformUserArray}},[a("i",{staticClass:"el-icon-delete "},[e._v("批量删除")])])],1),e._v(" "),a("div",{staticStyle:{float:"right","margin-right":"20px"}},[a("el-button",{attrs:{type:"primary",size:"small",title:"新增数据"},on:{click:e.accountUserAdd}},[a("i",{staticClass:"el-icon-edit "},[e._v("新增")])])],1)]),e._v(" "),a("el-tooltip",{attrs:{content:"展开与隐藏功能按钮",placement:"top"}},[a("el-button",{directives:[{name:"trigger",rawName:"v-trigger"}],ref:"ballBtn",class:[!0===e.ballShow?"fadeIn":"fadeOut"],attrs:{id:"ballBtn",type:"primary",icon:"el-icon-close",icon:this.ballIcon,circle:""},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.openBox(t)}}})],1)],1)]),e._v(" "),a("el-table",{ref:"thermalUserTable",staticClass:"account-table-fixed-right account-table-fixed",attrs:{border:"",data:e.tableData,"tooltip-effect":"dark","row-style":{height:"10px"},"cell-style":{padding:"5px 0px"},"row-key":e.getRowKeys,"header-cell-style":{background:"#4B86BC",color:"#ffffff",borderRight:"1px solid #E3E5EB",padding:"0px",height:"45px","line-height":"45px"}},on:{"sort-change":e.sortColumn,"selection-change":e.handleSelectionChange}},[e.submitColm?a("el-table-column",{attrs:{type:"selection",selectable:e.isSelect,width:"55","reserve-selection":!0}}):e._e(),e._v(" "),e.clmShow?a("el-table-column",{attrs:{prop:"cui_uuid",label:"用户ID",align:"center","show-overflow-tooltip":"",width:"300"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{fixed:"left",prop:"cui_login_id",label:"登录标识",align:"center","show-overflow-tooltip":"",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ci_company_name",label:"所属公司",align:"center","show-overflow-tooltip":"",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"cui_type",label:"用户类型",align:"center","show-overflow-tooltip":"",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"===t.row.cui_type?a("el-tag",{attrs:{size:"small",effect:"dark",type:"primary"}},[e._v("总公司用户")]):e._e(),e._v(" "),"2"===t.row.cui_type?a("el-tag",{attrs:{size:"small",effect:"dark",type:"success"}},[e._v("分公司用户")]):e._e(),e._v(" "),"3"===t.row.cui_type?a("el-tag",{attrs:{size:"small",effect:"dark",type:"warning"}},[e._v("热力所用户")]):e._e(),e._v(" "),"4"===t.row.cui_type?a("el-tag",{attrs:{size:"small",effect:"dark",type:"info"}},[e._v("换热站用户")]):e._e()]}}])}),e._v(" "),e.clmShow?a("el-table-column",{attrs:{prop:"cui_password",label:"登录口令",align:"center","show-overflow-tooltip":"",width:"150"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"cui_realname",label:"真实名称",align:"center",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"cui_concat_phone",label:"用户状态",align:"center","show-overflow-tooltip":"",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[2==t.row.cui_status?a("el-tag",{attrs:{size:"small",effect:"dark",type:"danger"}},[e._v("禁用")]):e._e(),e._v(" "),1==t.row.cui_status?a("el-tag",{attrs:{size:"small",effect:"dark",type:"success"}},[e._v("启用")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"cui_admin_type",label:"二级管理员",align:"center","show-overflow-tooltip":"",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"===t.row.cui_admin_type?a("el-tag",{attrs:{size:"small",effect:"dark",type:"warning"}},[e._v("是")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"cui_writetime",label:"修改时间",align:"center","show-overflow-tooltip":"",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cui_wx_open_id",label:"微信OPENID",align:"center","show-overflow-tooltip":"",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cui_wx_union_id",label:"微信UNIONID",align:"center","show-overflow-tooltip":"",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cui_wx_nick_name",label:"微信昵称",align:"center","show-overflow-tooltip":"",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"cui_concat_phone",label:"联系电话",align:"center","show-overflow-tooltip":"",width:"150"}}),e._v(" "),e.submitColm?a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"230",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{content:"编辑",placement:"top"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.cui_login_id!==e.loginName,expression:"scope.row.cui_login_id===loginName?false:true"}],attrs:{type:"primary",icon:"el-icon-edit",circle:"",size:"mini"},nativeOn:{click:function(a){return a.stopPropagation(),e.accountUserEdit(t.row)}}})],1),e._v(" "),a("el-tooltip",{attrs:{content:"删除",placement:"top"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.cui_login_id!==e.loginName,expression:"scope.row.cui_login_id===loginName?false:true"}],attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini"},nativeOn:{click:function(a){return a.stopPropagation(),e.accountUserDel(t.row)}}})],1),e._v(" "),a("el-tooltip",{attrs:{content:"机构授权",placement:"top"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.cui_login_id!==e.loginName,expression:"scope.row.cui_login_id===loginName?false:true"}],attrs:{type:"warning",icon:"el-icon-connection",circle:"",size:"mini"},nativeOn:{click:function(a){return a.stopPropagation(),e.showOrgTree(t.row)}}})],1),e._v(" "),a("el-tooltip",{attrs:{content:"按钮禁用",placement:"top"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.cui_login_id!==e.loginName,expression:"scope.row.cui_login_id===loginName?false:true"}],attrs:{type:"success",icon:"el-icon-turn-off",circle:"",size:"mini"},nativeOn:{click:function(a){return a.stopPropagation(),e.platformUserBtn(t.row)}}})],1),e._v(" "),a("el-tooltip",{attrs:{content:"重置密码",placement:"top"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.cui_login_id!==e.loginName,expression:"scope.row.cui_login_id===loginName?false:true"}],attrs:{type:"info",icon:"el-icon-refresh",circle:"",size:"mini"},nativeOn:{click:function(a){return a.stopPropagation(),e.resetUserPasswd(t.row)}}})],1)]}}],null,!1,1517151158)}):e._e()],1)],1),e._v(" "),a("el-pagination",{attrs:{background:"","current-page":e.queryParam.currentPage,"page-sizes":[10,20,50,100,200],"page-size":e.queryParam.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.queryParam.totalRow},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("el-dialog",{staticClass:"account-dialog",attrs:{visible:e.thermalUserFormVisible,"close-on-press-escape":!1,"close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(t){e.thermalUserFormVisible=t}}},[a("div",{staticStyle:{"text-align":"left","font-size":"20px","font-weight":"bold"},attrs:{slot:"title"},slot:"title"},[a("span",[e._v(e._s(this.tableDialgTitle))])]),e._v(" "),a("div",[a("el-card",{staticClass:"account-card1",staticStyle:{"background-color":"#d6d6d6",padding:"5px 20px 5px 20px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"font-size":"16px"}},[e._v("用户信息")])]),e._v(" "),a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"font-size":"16px"}},[e._v("赋予权限信息")]),e._v("("+e._s(this.menuNum)+")")])],1)],1),e._v(" "),a("el-card",{staticClass:"account-card1",staticStyle:{padding:"5px 20px 5px 20px"}},[a("el-container",[a("el-aside",{staticStyle:{width:"50%","background-color":"white"}},[a("el-form",{ref:"thermalUserForm",staticClass:"account-formitem",staticStyle:{"text-align":"left","font-size":"20px","font-weight":"bold","margin-top":"10px"},attrs:{model:e.thermalUserForm,rules:e.permissionFormRules,"label-width":"130px"}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:this.passwdShow,expression:"this.passwdShow"}],attrs:{label:"登录标识",prop:"cui_login_id",rules:this.permissionFormRules.cui_login_id}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.thermalUserForm.cui_login_id,callback:function(t){e.$set(e.thermalUserForm,"cui_login_id",t)},expression:"thermalUserForm.cui_login_id"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:this.passwdShow,expression:"this.passwdShow"}],attrs:{label:"登录口令",prop:"cui_password",rules:this.permissionFormRules.cui_password}},[a("el-input",{staticStyle:{width:"80%"},attrs:{"show-password":""},model:{value:e.thermalUserForm.cui_password,callback:function(t){e.$set(e.thermalUserForm,"cui_password",t)},expression:"thermalUserForm.cui_password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"真实姓名",prop:"cui_realname",rules:this.permissionFormRules.cui_realname}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.thermalUserForm.cui_realname,callback:function(t){e.$set(e.thermalUserForm,"cui_realname",t)},expression:"thermalUserForm.cui_realname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"微信OPENID",prop:"cui_wx_open_id"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.thermalUserForm.cui_wx_open_id,callback:function(t){e.$set(e.thermalUserForm,"cui_wx_open_id",t)},expression:"thermalUserForm.cui_wx_open_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"微信UNIONID",prop:"cui_wx_uninon_id"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.thermalUserForm.cui_wx_union_id,callback:function(t){e.$set(e.thermalUserForm,"cui_wx_union_id",t)},expression:"thermalUserForm.cui_wx_union_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"微信昵称",prop:"cui_wx_nick_name"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.thermalUserForm.cui_wx_nick_name,callback:function(t){e.$set(e.thermalUserForm,"cui_wx_nick_name",t)},expression:"thermalUserForm.cui_wx_nick_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系电话",prop:"cui_concat_phone",rules:this.permissionFormRules.cui_concat_phone}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.thermalUserForm.cui_concat_phone,callback:function(t){e.$set(e.thermalUserForm,"cui_concat_phone",t)},expression:"thermalUserForm.cui_concat_phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"二级管理员",prop:"cui_admin_type"}},[a("el-switch",{staticStyle:{display:"block","margin-top":"8px",width:"20%"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949",disabled:this.adminStatus},model:{value:e.thermalUserForm.cui_admin_type,callback:function(t){e.$set(e.thermalUserForm,"cui_admin_type",t)},expression:"thermalUserForm.cui_admin_type"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态",prop:"cui_status"}},[a("el-switch",{staticStyle:{display:"block","margin-top":"8px",width:"20%"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.thermalUserForm.cui_status,callback:function(t){e.$set(e.thermalUserForm,"cui_status",t)},expression:"thermalUserForm.cui_status"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色",prop:"r_memo"}},[a("el-select",{staticStyle:{width:"80%"},attrs:{placeholder:"请选角色"},on:{change:function(t){return e.getPermiessionId(t)}},model:{value:e.roleId,callback:function(t){e.roleId=t},expression:"roleId"}},e._l(e.roleSelect,function(e,t){return a("el-option",{key:e.r_uuid,attrs:{label:e.r_caption,value:e.r_uuid}})}),1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"ID",prop:"cui_uuid"}},[a("el-input",{model:{value:e.thermalUserForm.cui_uuid,callback:function(t){e.$set(e.thermalUserForm,"cui_uuid",t)},expression:"thermalUserForm.cui_uuid"}})],1)],1)],1),e._v(" "),a("el-container",[a("el-table",{key:e.refreshTableData,ref:"thermalRoleTreeTable",staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{height:"410",data:e.tableTreeData,"row-key":"id",border:"","default-expand-all":"","tree-props":{children:"detail",hasChildren:"hasChildren"}},on:{"select-all":e.tableTreeSelectAll,select:e.tableTreeSingleSelect,"selection-change":e.tableTreeSelectChange}},[a("el-table-column",{attrs:{type:"selection",selectable:e.isSelect,width:"50"}}),e._v(" "),e.clmShow?a("el-table-column",{attrs:{prop:"id",label:"ID"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"caption",label:"权限名称"}})],1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.resetForm("thermalUserForm")}}},[e._v("重 置")]),e._v(" "),a("el-button",{on:{click:function(t){return e.closeDialog()}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("thermalUserForm")}}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{staticClass:"account-dialog",attrs:{visible:e.thermalUserOrgVisible,"close-on-press-escape":!1,"close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(t){e.thermalUserOrgVisible=t}}},[a("div",{staticStyle:{"text-align":"left","font-size":"20px","font-weight":"bold"},attrs:{slot:"title"},slot:"title"},[a("span",[e._v("热力用户机构授权")])]),e._v(" "),a("div",[a("el-card",{staticClass:"account-card1",staticStyle:{"background-color":"#d6d6d6",padding:"5px 20px 5px 20px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"font-size":"16px"}},[e._v("用户信息")])]),e._v(" "),a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"font-size":"16px"}},[e._v("分配机构信息")])])],1)],1),e._v(" "),a("el-card",{staticClass:"account-card1",staticStyle:{padding:"5px 20px 5px 20px"}},[a("el-container",{staticStyle:{height:"60vh"}},[a("el-aside",{attrs:{width:"50%"}},[a("el-form",{ref:"platformOrg",staticStyle:{"text-align":"left","font-size":"20px","font-weight":"bold","margin-top":"100px"},attrs:{"label-width":"130px"}},[a("el-form-item",{attrs:{label:"登录标识",prop:"cui_login_id"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{disabled:!0},model:{value:this.loginIdByOrg,callback:function(t){e.$set(this,"loginIdByOrg",t)},expression:"this.loginIdByOrg"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"真实姓名",prop:"cui_realname"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{disabled:!0},model:{value:this.realNameByOrg,callback:function(t){e.$set(this,"realNameByOrg",t)},expression:"this.realNameByOrg"}})],1)],1)],1),e._v(" "),a("el-container",[e.showTree?a("el-tree",{ref:"thermalOrgTree",staticStyle:{height:"calc(100vh)",width:"100%"},attrs:{data:e.treeData,"check-strictly":!0,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":"",props:{children:"detail",label:"caption"},"render-content":e.initTreeDataStatus},on:{check:e.handleCheck}}):e._e()],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.resetForm("platformOrg")}}},[e._v("重 置")]),e._v(" "),a("el-button",{on:{click:function(t){e.thermalUserOrgVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitUserOrg}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{staticClass:"account-dialog",attrs:{visible:e.thermalUserBtnVisible,"close-on-press-escape":!1,"close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(t){e.thermalUserBtnVisible=t}}},[a("div",{staticStyle:{"text-align":"left","font-size":"20px","font-weight":"bold"},attrs:{slot:"title"},slot:"title"},[a("span",[e._v("热力用户按钮授权")])]),e._v(" "),a("div",[a("el-card",{staticClass:"account-card1",staticStyle:{"background-color":"#d6d6d6",padding:"5px 20px 5px 20px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"font-size":"16px"}},[e._v("用户信息")])]),e._v(" "),a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{"font-size":"16px"}},[e._v("禁用按钮信息")]),e._v("("+e._s(this.btnNum)+")")])],1)],1),e._v(" "),a("el-card",{staticClass:"account-card1",staticStyle:{padding:"5px 20px 5px 20px"}},[a("el-container",[a("el-aside",{attrs:{width:"50%"}},[a("el-form",{ref:"platformBtn",staticStyle:{"text-align":"left","font-size":"20px","font-weight":"bold","margin-top":"100px"},attrs:{"label-width":"130px"}},[a("el-form-item",{attrs:{label:"登录标识",prop:"cui_login_id"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{disabled:""},model:{value:this.loginIdByOrg,callback:function(t){e.$set(this,"loginIdByOrg",t)},expression:"this.loginIdByOrg"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"真实姓名",prop:"cui_realname"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{disabled:""},model:{value:this.realNameByOrg,callback:function(t){e.$set(this,"realNameByOrg",t)},expression:"this.realNameByOrg"}})],1)],1)],1),e._v(" "),a("el-container",[a("el-table",{key:e.refreshTableData,ref:"platBtnTreeTable",staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{height:"410",data:e.tableBtnTreeData,"row-key":"id",border:"","default-expand-all":"","tree-props":{children:"detail",hasChildren:"hasChildren"}},on:{"select-all":e.tableBtnTreeSelectAll,select:e.tableBtnTreeSingleSelect,"selection-change":e.tableBtnTreeSelectChange}},[a("el-table-column",{attrs:{type:"selection",selectable:e.isSelect,width:"50"}}),e._v(" "),e.clmShow?a("el-table-column",{attrs:{prop:"id",label:"ID"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"caption",label:"按钮名称"}})],1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.resetForm("platformBtn")}}},[e._v("重 置")]),e._v(" "),a("el-button",{on:{click:function(t){e.thermalUserBtnVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitUserBtn}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var p=a("VU/8")(h,m,!1,function(e){a("7xJQ"),a("f75Y")},"data-v-1f4f8a90",null);t.default=p.exports},f75Y:function(e,t){}});
//# sourceMappingURL=34.f09d384811c6f61d48f0.js.map