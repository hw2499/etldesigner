webpackJsonp([58],{"5IXv":function(t,e){},VIdR:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("mvHQ"),n=o.n(a),i={name:"PreferentialCustomers",data:function(){var t=this;return{ruleForm:{mau_guest_phone:""},ruleFormrules:{mau_guest_phone:[{required:!0,validator:function(e,o,a){""===o?a(new Error("手机号不能为空")):t.isCellPhone(o)?a():a(new Error("请输入正确的手机号!"))},trigger:"blur"}]},cardBodyStyle:"padding-top:10px;padding-bottom:10px;",icon1:"el-icon-caret-top",cardBodyHeight:!0,tableData:[],queryParam:{totalRow:0,currentPage:1,pageSize:this.customGlobal.pageSize},tableDialgTitle:"",commodityFormVisible:!1,commodityForm:{},commodityFormrule:{},tableData_prize:[],phone:"",mau_uuid:""}},created:function(){this.queryParam.currentPage=1,this.query_name()},methods:{isCellPhone:function(t){return!!/^1(3|4|5|6|7|8)\d{9}$/.test(t)},handleSizeChange:function(t){this.queryParam.pageSize=t,this.query_name()},handleCurrentChange:function(t){this.queryParam.currentPage=t,this.query_name()},confCardBodyHeigth:function(){!1===this.cardBodyHeight?(this.cardBodyHeight=!0,this.cardBodyStyle="padding-top:10px;padding-bottom:10px;",this.icon1="el-icon-caret-top"):(this.cardBodyHeight=!1,this.cardBodyStyle="padding-top:0px;padding-bottom:0px;",this.icon1="el-icon-caret-bottom")},query_name:function(){var t=this,e=this;e.tableData=[];var o={perPageSize:e.queryParam.pageSize,currentPage:e.queryParam.currentPage,obj_bank_center_id:e.customGlobal.userInfoExt.cui_bank_center_id,obj_province_id:e.customGlobal.userInfoExt.cui_province_id,obj_city_id:e.customGlobal.userInfoExt.cui_city_id,obj_county_id:e.customGlobal.userInfoExt.cui_county_id,obj_station_id:e.customGlobal.userInfoExt.cui_station_id,mau_guest_phone:e.ruleForm.mau_guest_phone},a=this.$loading({lock:!0,text:"提交中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0)"});this.customGlobal.postHttpClient(this.customGlobal.serverUrl.Customer_list_select,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:n()(o)})).then(function(o){"success"===o.data.status?(a.close(),e.tableData=o.data.rows,e.queryParam.totalRow=o.data.total):(console.info("手机号查询失败"),a.close(),"请登录认证"===o.data.msg&&t.$router.push({path:"/login"}))},function(e){a.close(),t.$alert(n()(e.message),"手机号查询失败!",{confirmButtonText:"确定",callback:function(t){}})}).catch(function(e){console.log("异步调用失败返回:"+n()(e)),a.close(),t.$alert(n()(e.message),"手机号查询失败",{confirmButtonText:"确定",callback:function(t){}})})},sortColumn:function(t){var e="";null!=t.order?("descending"===t.order?e="desc":"ascending"===t.order&&(e="asc"),this.sortOrderCol=t.prop+" "+e,this.query_name()):this.sortOrderCol=""},add_raffle:function(t,e){this.tableDialgTitle="次数管理",this.commodityFormVisible=!0,this.phone=e.mau_guest_phone_new,this.mau_uuid=e.mau_uuid,this.phone_lucky_draw()},delete_phone:function(t,e){var o=this;this.phone=e.mau_guest_phone_new,this.$confirm("确定要删除么?","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0,closeOnClickModal:!1,closeOnPressEscape:!1}).then(function(){var t=o,e={mau_guest_phone:t.phone,mau_cui_id_2:t.customGlobal.userInfoExt.cui_uuid,obj_bank_center_id:t.customGlobal.userInfoExt.cui_bank_center_id,obj_province_id:t.customGlobal.userInfoExt.cui_province_id,obj_city_id:t.customGlobal.userInfoExt.cui_city_id,obj_county_id:t.customGlobal.userInfoExt.cui_county_id,obj_station_id:t.customGlobal.userInfoExt.cui_station_id},a=o.$loading({lock:!0,text:"提交中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0)"});o.customGlobal.postHttpClient(o.customGlobal.serverUrl.Customer_list_update,o.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},o.qs.stringify({jsondata:n()(e)})).then(function(t){"success"==t.data.status?(a.close(),o.$message({type:"success",showClose:!0,duration:3e3,dangerouslyUseHTMLString:!0,message:'<span style="color:black;">删除成功</span>'}),o.queryParam.currentPage=1,o.query_name()):(console.info("删除失败"),a.close(),"请登录认证"===t.data.msg&&o.$router.push({path:"/login"}))},function(t){a.close(),o.$alert(n()(t.message),"删除出错!",{confirmButtonText:"确定",callback:function(t){}})}).catch(function(t){console.log("异步调用失败返回:"+n()(t)),a.close(),o.$alert(n()(t.message),"删除出错",{confirmButtonText:"确定",callback:function(t){}})})}).catch(function(){o.$message({type:"info",message:"已取消保存"})})},platformAddRole:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.phone=e.ruleForm.mau_guest_phone,e.add_phone()})},prize_add:function(){this.add_phone(),this.phone_lucky_draw()},handleClose:function(){this.commodityFormVisible=!1,this.queryParam.currentPage=1,this.query_name()},phone_lucky_draw:function(){var t=this,e=this;e.tableData_prize=[];var o={mau_guest_phone:e.phone,obj_bank_center_id:e.customGlobal.userInfoExt.cui_bank_center_id,obj_province_id:e.customGlobal.userInfoExt.cui_province_id,obj_city_id:e.customGlobal.userInfoExt.cui_city_id,obj_county_id:e.customGlobal.userInfoExt.cui_county_id,obj_station_id:e.customGlobal.userInfoExt.cui_station_id,perPageSize:100,currentPage:1},a=this.$loading({lock:!0,text:"提交中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0)"});this.customGlobal.postHttpClient(this.customGlobal.serverUrl.Number_of_purchases_select,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:n()(o)})).then(function(o){"success"==o.data.status?(a.close(),e.tableData_prize=o.data.rows):(console.info("购买次数查询失败"),a.close(),"请登录认证"===o.data.msg&&t.$router.push({path:"/login"}))},function(e){a.close(),t.$alert(n()(e.message),"购买次数查询出错!",{confirmButtonText:"确定",callback:function(t){}})}).catch(function(e){console.log("异步调用失败返回:"+n()(e)),a.close(),t.$alert(n()(e.message),"购买次数查询出错",{confirmButtonText:"确定",callback:function(t){}})})},add_phone:function(){var t=this,e=this,o={mau_guest_phone:e.phone,mau_cui_id:e.customGlobal.userInfoExt.cui_uuid,obj_bank_center_id:e.customGlobal.userInfoExt.cui_bank_center_id,obj_province_id:e.customGlobal.userInfoExt.cui_province_id,obj_city_id:e.customGlobal.userInfoExt.cui_city_id,obj_county_id:e.customGlobal.userInfoExt.cui_county_id,obj_station_id:e.customGlobal.userInfoExt.cui_station_id},a=this.$loading({lock:!0,text:"提交中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0)"});this.customGlobal.postHttpClient(this.customGlobal.serverUrl.Add_phone_number_and_purchase_opportunity,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:n()(o)})).then(function(o){"success"==o.data.status?(a.close(),t.$message({type:"success",showClose:!0,duration:3e3,dangerouslyUseHTMLString:!0,message:'<span style="color:black;">新增成功 </span>'}),e.ruleForm.mau_guest_phone="",t.queryParam.currentPage=1,t.query_name()):(console.info("新增失败"),a.close(),"请登录认证"===o.data.msg&&t.$router.push({path:"/login"}))},function(e){a.close(),t.$alert(n()(e.message),"新增出错!",{confirmButtonText:"确定",callback:function(t){}})}).catch(function(e){console.log("异步调用失败返回:"+n()(e)),a.close(),t.$alert(n()(e.message),"新增出错",{confirmButtonText:"确定",callback:function(t){}})})},User_prize_delete:function(t,e){var o=this;this.$confirm("确定要删除么?","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0,closeOnClickModal:!1,closeOnPressEscape:!1}).then(function(){var t=o,a={mau_uuid:e.mau_uuid,mau_cui_id_2:t.customGlobal.userInfoExt.cui_uuid},i=o.$loading({lock:!0,text:"提交中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0)"});o.customGlobal.postHttpClient(o.customGlobal.serverUrl.Number_of_purchases_update,o.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},o.qs.stringify({jsondata:n()(a)})).then(function(t){"success"==t.data.status?(i.close(),o.$message({type:"success",showClose:!0,duration:3e3,dangerouslyUseHTMLString:!0,message:'<span style="color:black;">删除成功</span>'}),o.phone_lucky_draw()):(console.info("删除失败"),i.close(),"请登录认证"===t.data.msg&&o.$router.push({path:"/login"}))},function(t){i.close(),o.$alert(n()(t.message),"删除出错!",{confirmButtonText:"确定",callback:function(t){}})}).catch(function(t){console.log("异步调用失败返回:"+n()(t)),i.close(),o.$alert(n()(t.message),"删除出错",{confirmButtonText:"确定",callback:function(t){}})})}).catch(function(){o.$message({type:"info",message:"已取消保存"})})}}},l={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-form",{ref:"ruleForm",staticClass:"account-plat-formitem",staticStyle:{"text-align":"left","font-size":"20px"},attrs:{"label-position":"left",model:t.ruleForm,rules:t.ruleFormrules,"label-width":"130px"},nativeOn:{submit:function(t){t.preventDefault()}}},[o("el-card",{staticClass:"account-plat-card1 account-plat-card2",attrs:{shadow:"always","body-style":t.cardBodyStyle}},[o("div",{staticStyle:{"font-size":"14px","font-weight":"bold"},attrs:{slot:"header"},on:{click:t.confCardBodyHeigth},slot:"header"},[o("el-row",{on:{click:t.confCardBodyHeigth}},[o("el-col",{attrs:{md:22}},[o("span",{staticStyle:{"margin-top":"5px",display:"block"}},[t._v("客户列表")])]),t._v(" "),o("el-col",{attrs:{md:1},on:{click:t.confCardBodyHeigth}},[o("el-link",{staticStyle:{float:"right","text-decoration":"none","font-size":"20px",height:"10px","line-height":"10px","margin-top":"10px"},attrs:{icon:t.icon1,underline:!1}})],1)],1)],1),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.cardBodyHeight,expression:"cardBodyHeight"}],staticStyle:{margin:"10px 0"}},[o("div",{staticStyle:{width:"100%",display:"flex","justify-content":"space-between"}},[o("div",{staticStyle:{width:"50%"}},[o("el-form-item",{attrs:{label:"手机号码:",prop:"mau_guest_phone","label-width":"130px"}},[o("el-input",{staticStyle:{width:"300px"},attrs:{maxlength:11,placeholder:"请输入手机号"},model:{value:t.ruleForm.mau_guest_phone,callback:function(e){t.$set(t.ruleForm,"mau_guest_phone",e)},expression:"ruleForm.mau_guest_phone"}})],1)],1),t._v(" "),o("div",{staticStyle:{width:"170px",margin:"0 50px 0"}},[o("el-button",{attrs:{type:"primary"},on:{click:t.query_name}},[t._v("查询")]),t._v(" "),o("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(e){return t.platformAddRole("ruleForm")}}},[o("i",{staticClass:"el-icon-edit"},[t._v("新增")])])],1)])])])],1),t._v(" "),o("el-card",[o("el-table",{ref:"tableData",staticClass:"account-plat-fixed-right account-plat-fixed",attrs:{border:"",data:t.tableData,"tooltip-effect":"dark","row-style":{height:"10px"},"cell-style":{padding:"5px 0px"},"header-cell-style":{background:"#4B86BC",color:"#ffffff",borderRight:"1px solid #E3E5EB",padding:"0px",height:"45px","line-height":"45px"}},on:{"sort-change":t.sortColumn}},[o("el-table-column",{attrs:{fixed:"",align:"center",type:"index",label:"序号",width:"50"}}),t._v(" "),o("el-table-column",{attrs:{prop:"mau_guest_phone_new",label:"手机号",align:"center","show-overflow-tooltip":"",width:"150"}}),t._v(" "),o("el-table-column",{attrs:{prop:"zhengchang",label:"赋予特惠价购买次数",align:"center","show-overflow-tooltip":"",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"===e.row.mau_del_status_new?o("div",[t._v(t._s(e.row.zhengchang))]):t._e(),t._v(" "),"2"===e.row.mau_del_status_new?o("div",[t._v("0")]):t._e()]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"yiyong",label:"已用次数",align:"center","show-overflow-tooltip":"",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"===e.row.mau_del_status_new?o("div",[t._v(t._s(e.row.yiyong))]):t._e(),t._v(" "),"2"===e.row.mau_del_status_new?o("div",[t._v("0")]):t._e()]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"zuizhong",label:"未用次数",align:"center","show-overflow-tooltip":"",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"===e.row.mau_del_status_new?o("div",[t._v(t._s(e.row.zuizhong))]):t._e(),t._v(" "),"2"===e.row.mau_del_status_new?o("div",[t._v("0")]):t._e()]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"mau_del_status_new",label:"状态",align:"center","show-overflow-tooltip":"",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"===e.row.mau_del_status_new?o("el-tag",{attrs:{size:"small",effect:"dark",type:"success"}},[t._v("正常")]):t._e(),t._v(" "),"2"===e.row.mau_del_status_new?o("el-tag",{attrs:{size:"small",effect:"dark",type:"info"}},[t._v("删除")]):t._e()]}}])}),t._v(" "),o("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"===e.row.mau_del_status_new?o("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(o){return o.stopPropagation(),t.add_raffle(e.$index,e.row)}}},[t._v("次数管理")]):t._e(),t._v(" "),"1"===e.row.mau_del_status_new&"0"==e.row.yiyong?o("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(o){return o.stopPropagation(),t.delete_phone(e.$index,e.row)}}},[t._v("删除")]):t._e()]}}])})],1),t._v(" "),o("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{background:"","current-page":t.queryParam.currentPage,"page-sizes":[10,20,50,100,200],"page-size":t.queryParam.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.queryParam.totalRow},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),o("el-dialog",{staticClass:"account-plat-dialog",attrs:{visible:t.commodityFormVisible,"close-on-press-escape":!1,"close-on-click-modal":!1,"show-close":!1,width:"60%"},on:{"update:visible":function(e){t.commodityFormVisible=e}}},[o("div",{staticStyle:{"text-align":"left","font-size":"20px","font-weight":"bold"},attrs:{slot:"title"},slot:"title"},[o("span",[t._v(t._s(this.tableDialgTitle))])]),t._v(" "),o("el-form",{ref:"commodityForm",staticClass:"account-plat-formitem",staticStyle:{"text-align":"left","font-size":"20px","font-weight":"bold","margin-top":"10px"},attrs:{model:t.commodityForm,rules:t.commodityFormrule,"label-width":"120px"}},[o("el-row",{attrs:{gutter:24}},[o("el-col",{staticStyle:{margin:"20px 0"},attrs:{md:22}},[o("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.prize_add}},[o("i",{staticClass:"el-icon-edit"},[t._v("添加特惠价购买次数")])])],1),t._v(" "),o("el-table",{ref:"tableData_prize",staticClass:"account-plat-fixed-right account-plat-fixed ",staticStyle:{"margin-left":"50px",width:"90%","margin-bottom":"50px"},attrs:{data:t.tableData_prize,border:"","tooltip-effect":"dark","row-style":{height:"10px"},"cell-style":{padding:"5px 0px"},"header-cell-style":{background:"#4B86BC",color:"#ffffff",borderRight:"1px solid #E3E5EB",padding:"0px",height:"45px","line-height":"45px"}},on:{"sort-change":t.sortColumn}},[o("el-table-column",{attrs:{fixed:"",align:"center",type:"index",label:"序号",width:"50"}}),t._v(" "),o("el-table-column",{attrs:{prop:"mau_guest_phone",label:"手机号",align:"center","show-overflow-tooltip":"",width:"150"}}),t._v(" "),o("el-table-column",{attrs:{label:"商品名称",align:"center","show-overflow-tooltip":"",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.mau_get_status?o("div",[t._v(t._s(e.row.mbgi_goods_name))]):t._e(),t._v(" "),"2"===e.row.mau_get_status||"3"===e.row.mau_get_status?o("div",[t._v("未购买")]):t._e()]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"金额（元）",align:"center","show-overflow-tooltip":"",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.mau_get_status?o("div",[t._v(t._s(e.row.mbs_money_1))]):t._e(),t._v(" "),"2"===e.row.mau_get_status||"3"===e.row.mau_get_status?o("div",[t._v("未购买")]):t._e()]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"购买时间",align:"center","show-overflow-tooltip":"",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.mau_get_status?o("div",[t._v(t._s(e.row.mbs_writetime))]):t._e(),t._v(" "),"2"===e.row.mau_get_status||"3"===e.row.mau_get_status?o("div",[t._v("未购买")]):t._e()]}}])}),t._v(" "),o("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["2"===e.row.mau_get_status||"3"===e.row.mau_get_status?o("el-tooltip",{attrs:{content:"删除",placement:"top"}},[o("el-button",{attrs:{type:"danger",icon:"el-icon-switch-button",circle:"",size:"mini"},nativeOn:{click:function(o){return o.stopPropagation(),t.User_prize_delete(e.$index,e.row)}}})],1):t._e()]}}])})],1)],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){return t.handleClose()}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var s=o("VU/8")(i,l,!1,function(t){o("5IXv")},"data-v-4093ee99",null);e.default=s.exports}});
//# sourceMappingURL=58.4709ade21d640a6d245f.js.map