webpackJsonp([23,36],{"3GxC":function(e,t){},"6Kq+":function(e,t){},FScV:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("fZjL"),n=r.n(o),a=r("BO1k"),i=r.n(a),s=r("mvHQ"),c=r.n(s),l=r("Vhou"),d={components:{OrgCenterForComapnyUser:r("pJgO").default},name:"OrgTreeIndexForCompanyUser",data:function(){return{icon1:"el-icon-caret-left",showTree:!0,currentSelTreeNodeId:"",currentSelTreeNodeIds:[],treeDataStatus:{},treeData:[{id:"0",caption:"智慧供热平台",type:"0",detail:[{id:"100",caption:"热力公司1",type:"1",detail:[{id:"100_1",caption:"热力分公司1_1",type:"2",detail:[{id:"100_1_1",caption:"热力所1",type:"3",detail:[{id:"100_1_1_1",caption:"换热站1",type:"4"},{id:"100_1_1_2",caption:"换热站2",type:"4"}]},{id:"100_1_2",caption:"热力所2",type:"3"}]},{id:"100_2",caption:"热力分公司1_2",type:"2"}]},{id:"200",caption:"热力公司2",type:"1",detail:[{id:"200_1",caption:"热力分公司2_1",type:"2"},{id:"200_2",caption:"热力分公司2_2",type:"2"}]}]}]}},created:function(){this.initOrgTemplateInfo()},methods:{removeTreeNode:function(e,t){var r=e.parent,o=r.data.detail||r.data,n=o.findIndex(function(e){return e.id===t.id});o.splice(n,1)},initTreeDataStatus:function(e,t){var r=t.node,o=t.data;t.store;if("{}"===c()(this.treeDataStatus))return e("span",{style:"font-size:14px;"},[e("span",[o.caption])]);var a=!1,s=!0,l=!1,d=void 0;try{for(var p,u=i()(n()(this.treeDataStatus));!(s=(p=u.next()).done);s=!0){var h=p.value;if(o.id===h)return console.info(h+",显示"+o.caption),e("span",[e("span",[o.caption])])}}catch(e){l=!0,d=e}finally{try{!s&&u.return&&u.return()}finally{if(l)throw d}}!1===a&&this.removeTreeNode(r,o)},initOrgTemplateInfo:function(){var e=this,t=this.$loading({lock:!0,text:"查询中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, .7)"});this.customGlobal.postHttpClient(this.customGlobal.serverUrl.postQueryOrganTemplate,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:c()({config:"all",username:this.customGlobal.userInfoExt.cui_login_id})})).then(function(r){console.log("异步调用成功返回:"+c()(r)),"success"==r.data.status?(e.treeData=[JSON.parse(r.data.organ)],e.treeDataStatus=JSON.parse(r.data.orgkey),t.close()):(console.info("查询失败"),"请登录认证"===r.data.msg&&"failed"===r.data.status?e.$router.replace({path:"/login"}):(e.treeData=[JSON.parse(r.data.organ)],e.treeDataStatus=JSON.parse(r.data.orgkey)),t.close())},function(r){console.log("异步调用出错:"+c()(r)),t.close(),e.$alert(c()(r.message),"保存出错!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(r){console.log("异步调用失败返回:"+c()(r)),t.close(),e.$alert(c()(r.message),"保存出错",{confirmButtonText:"确定",callback:function(e){}})})},showHiddenTree:function(){this.showTree?this.icon1="el-icon-caret-right":this.icon1="el-icon-caret-left",this.showTree=!this.showTree,console.info("是否显示："+this.showTree)},handleTreeNodeClick:function(e,t){var r=[],o=[],n=[],a=[];r.push(this.$refs.org_tree.getCurrentNode().caption),o.push(this.$refs.org_tree.getCurrentNode().id),n.push(this.$refs.org_tree.getCurrentNode().type+""),a.push({id:this.$refs.org_tree.getCurrentNode().id,caption:this.$refs.org_tree.getCurrentNode().caption,type:this.$refs.org_tree.getCurrentNode().type+""}),this.getTreeNodeParentCaption2(r,o,n,a,this.$refs.org_tree.getCurrentNode());this.$refs.org_tree.getNode(this.$refs.org_tree.getCurrentNode()).level;if(this.currentSelTreeNodeId!==this.$refs.org_tree.getCurrentKey()){this.currentSelTreeNodeId=this.$refs.org_tree.getCurrentKey();for(var i=0;i<r.length;i++)r[i]=this.customGlobal.encrypt(r[i],this.customGlobal.cryptoKey);this.currentSelTreeNodeIds=o.reverse(),console.info("currentSelTreeNodeIds:"+this.currentSelTreeNodeIds),l.a.$emit("globalMsgForCompanyUser",{cur_obj:{orgid:this.currentSelTreeNodeId,caption:this.$refs.org_tree.getCurrentNode().caption,type:this.$refs.org_tree.getCurrentNode().type+""},orgid:this.currentSelTreeNodeId,caption:r.reverse(),id:this.currentSelTreeNodeIds,type:n.reverse(),obj:a.reverse()})}},getTreeNodeParentCaption2:function(e,t,r,o,n){for(var a=this.$refs.org_tree.getNode(n),i=a.level,s=1;s<i;)void 0!==a.parent&&(e.push(a.parent.label),t.push(a.parent.key),r.push(a.parent.data.type+""),o.push({id:a.parent.key,caption:a.parent.label,type:a.parent.data.type+""}),a=this.$refs.org_tree.getNode(a.parent),s++);return{label:e,key:t,type:r,obj:o}}}},p={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-card",{attrs:{shadow:"always"}},[r("el-container",{staticStyle:{width:"100%",border:"1px solid #eee"}},[e.showTree?r("el-aside",{staticStyle:{height:"calc(100vh)","background-color":"rgb(238, 241, 246)"},attrs:{width:"200px"}},[e.showTree?r("el-tree",{ref:"org_tree",staticStyle:{height:"calc(100vh)"},attrs:{data:e.treeData,"default-expand-all":"","node-key":"id","highlight-current":"",props:{children:"detail",label:"caption"},"render-content":e.initTreeDataStatus},on:{"node-click":e.handleTreeNodeClick}}):e._e()],1):e._e(),e._v(" "),r("el-container",{staticStyle:{width:"100%",border:"1px solid #eee"}},[r("el-aside",{staticStyle:{height:"calc(100vh)","background-color":"rgb(238, 241, 246)"},attrs:{width:"25px"}},[r("i",{class:e.icon1,staticStyle:{height:"100%",display:"flex",width:"25px","flex-direction":"row","justify-content":"center","align-items":"center"},on:{click:e.showHiddenTree}})]),e._v(" "),r("el-main",{staticStyle:{height:"100%","padding-top":"0px"}},[r("org-center-for-comapny-user")],1)],1)],1)],1)],1)},staticRenderFns:[]};var u=r("VU/8")(d,p,!1,function(e){r("6Kq+")},"data-v-1629f82b",null);t.default=u.exports},pJgO:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("mvHQ"),n=r.n(o),a=r("Vhou"),i={name:"OrgCenterForComapnyUser",destroyed:function(){a.a.$off("globalMsgForCompanyUser")},mounted:function(){a.a.$on("globalMsgForCompanyUser",function(e){console.log("监听到的消息："+n()(e)),this.tmpCaption=[];for(var t=0;t<e.caption.length;t++)this.tmpCaption[t]=this.customGlobal.decrypt(e.caption[t],this.customGlobal.cryptoKey);console.info("机构名称："+this.tmpCaption)})}},s={render:function(){var e=this.$createElement;return(this._self._c||e)("div")},staticRenderFns:[]};var c=r("VU/8")(i,s,!1,function(e){r("3GxC")},"data-v-e0426434",null);t.default=c.exports}});
//# sourceMappingURL=23.a4b4ec31a04bfba368f0.js.map