webpackJsonp([42],{AauG:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("mvHQ"),o=a.n(n),i=a("bOdI"),s=a.n(i),l={data:function(){var e;return{addQueryList:[],StateManagementDate:{},serviceChargeMsg:{name:"xxxxxx",accountNumber:"xxxxxx",dialogVisible:!1,obj:[],msg:[{name:"设备",key:"di_describe"},{name:"网点内设备编号",key:"doi_active_id"}]},textarea:"",value:{},notApproved:{currentPage:1,perPageSize:10,total:0,tableMsg:[{key:"bma_to_device_uuid",name:"设备编号"},{key:"mbmi_mer_name",name:"商户名称"},{key:"bsi_name",name:"签约网点"},{key:"bii_name",name:"所属行业"},{key:"bms_address",name:"地址"},{key:"mbmi_phone",name:"联系电话"}],tableData:[]},tableMsg:[{key:"number",name:"序号"},{key:"type",name:"审核类型"},{key:"name",name:"商户名称"},{key:"industry",name:"所属行业"},{key:"phone",name:"联系电话"}],StateManagement:(e={radio:"1",input:"",currentPage:1,perPageSize:10,total:0},s()(e,"input",""),s()(e,"dialogVisible",!1),s()(e,"msg",{}),s()(e,"tableData",[]),e),currentCompanyId:"",mid:"",headerStyle:{background:"#4B86BC",color:"#ffffff",borderRight:"1px solid #E3E5EB",padding:"0px",height:"45px","line-height":"45px"},tableData:[{date:"2016-05-02",name:"王小虎",province:"上海",city:"普陀区",address:"上海市普陀区金沙江路 1518 弄",zip:200333}]}},created:function(){this.getData(),this.bank_commodity()},methods:{getData:function(){var e=this,t=this,a={currentPage:this.notApproved.currentPage,perPageSize:this.notApproved.perPageSize,manager_status:2,obj_bank_center_id:this.customGlobal.userInfoExt.cui_bank_center_id,obj_province_id:this.customGlobal.userInfoExt.cui_province_id,obj_city_id:this.customGlobal.userInfoExt.cui_city_id,obj_county_id:this.customGlobal.userInfoExt.cui_county_id,obj_station_id:this.customGlobal.userInfoExt.cui_station_id},n=this.$loading({lock:!0,text:"提交中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0)"});this.customGlobal.postHttpClient(this.customGlobal.serverUrl.merchant_pending_review_query,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:o()(a)})).then(function(a){console.log("异步调用成功返回:"+o()(a)),"success"==a.data.status?(t.notApproved.tableData=a.data.rows,t.notApproved.total=a.data.total,n.close()):(t.notApproved.tableData=[],console.info("商户查询失败"),n.close(),"请登录认证"===a.data.msg&&e.$router.push({path:"/login"}))},function(a){console.log("异步调用出错:"+o()(a)),n.close(),t.notApproved.tableData=[],e.$alert(o()(a.message),"商户查询失败!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(a){console.log("异步调用失败返回:"+o()(a)),n.close(),t.notApproved.tableData=[],e.$alert(o()(a.message),"商户查询失败！",{confirmButtonText:"确定",callback:function(e){}})})},PopupControl:function(e,t,a,n){this.StateManagementDate={msg:a,i:n},t.dialogVisible=!0,t.name=e.row.mbmi_mer_name,t.obj=e.row,this.addQueryClick(t.obj.mbmi_uuid,t.obj.bma_to_device_uuid)},addQueryClick:function(e,t){var a=this,n=this,i={perPageSize:"10",currentPage:"1",bma_mer_uuid:e,bma_to_bank_station_uuid:this.customGlobal.userInfoExt.cui_station_id,bma_to_device_uuid:t},s=this.$loading({lock:!0,text:"提交中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0)"});this.customGlobal.postHttpClient(this.customGlobal.serverUrl.Service_fee_for_foreign_households_to_be_reviewed_select,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:o()(i)})).then(function(e){"success"==e.data.status?(n.addQueryList=e.data.rows,n.addQueryList.forEach(function(e){e.mbbb_fee?a.$set(e,"bank_fee",e.mbbb_fee):a.$set(e,"bank_fee","0")}),s.close()):(n.addQueryList=[],console.info("查询表格数据失败"),s.close(),"请登录认证"===e.data.msg&&a.$router.push({path:"/login"}))},function(e){console.log("异步调用出错:"+o()(e)),s.close(),n.addQueryList=[],a.$alert(o()(e.message),"查询表格数据失败!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(e){console.log("异步调用失败返回:"+o()(e)),s.close(),n.addQueryList=[],a.$alert(o()(e.message),"查询表格数据失败!",{confirmButtonText:"确定",callback:function(e){}})})},bank_commodity:function(){var e=this,t=this,a={companyId:this.customGlobal.userInfoExt.cui_station_id},n=this.$loading({lock:!0,text:"",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0)"});this.customGlobal.postHttpClient(this.customGlobal.serverUrl.bank_transcoding,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:o()(a)})).then(function(a){"success"==a.data.status?(n.close(),t.currentCompanyId=a.data.currentCompanyId,e.postBank13CompanyIdUnionClick()):(console.info("转码失败"),n.close(),"请登录认证"===a.data.msg&&e.$router.push({path:"/login"}))},function(t){n.close(),e.$alert(o()(t.message),"转码出错!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(t){console.log("异步调用失败返回:"+o()(t)),n.close(),e.$alert(o()(t.message),"转码出错",{confirmButtonText:"确定",callback:function(e){}})})},postBank13CompanyIdUnionClick:function(){var e=this,t={method:"1",bank_company_alias_id:this.currentCompanyId},a=this.$loading({lock:!0,text:"提交中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0)"});this.customGlobal.postHttpClient(this.customGlobal.serverUrl.postBank13CompanyIdUnionConfig,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:o()(t)})).then(function(t){"success"==t.data.status?(a.close(),t.data.msg?e.mid=JSON.parse(t.data.msg).mid:e.mid=""):(console.info("商户查询失败"),a.close(),"请登录认证"===t.data.msg&&e.$router.push({path:"/login"}))},function(t){console.log("异步调用出错:"+t),a.close(),e.$alert(o()(t.message),"查询关联设备失败!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(t){a.close(),e.$alert(o()(t.message),"查询关联设备失败",{confirmButtonText:"确定",callback:function(e){}})})},Select_shop:function(){var e=this,t=this.serviceChargeMsg.obj.mbmi_uuid;console.log(this.addQueryList),this.addQueryList.forEach(function(e){e.bank_fee=e.bank_fee?e.bank_fee:"0"});var a=this.addQueryList,n={method:"2",detail:a.map(function(a){return console.log((100-1*a.mbpb_fee-1*a.bank_fee-1*a.mbmp_fee).toFixed(2)+"","-0-0-0-0-0"),{bank_company_alias_id:e.currentCompanyId,device_uuid:a.bma_to_device_uuid,mer_uuid:t,value:{mer_uuid:t,device_uuid:a.bma_to_device_uuid,bank_uuid:e.customGlobal.userInfoExt.cui_station_id,platform_id:e.mid,platform_fee:a.mbpb_fee?a.mbpb_fee:"0",bank_id:e.mid,bank_fee:a.bank_fee?a.bank_fee:"0",other1_id:a.bmp_mid?a.bmp_mid:"",other1_fee:a.mbmp_fee?a.mbmp_fee:"0",mer_id:e.serviceChargeMsg.obj.mbmi_mid,mer_fee:(100-1*a.mbpb_fee-1*a.bank_fee-1*a.mbmp_fee).toFixed(2)+""}}})};console.log(n);var i=this.$loading({lock:!0,text:"提交中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0)"});this.customGlobal.postHttpClient(this.customGlobal.serverUrl.postBank13CompanyIdAndDeviceUnionConfig,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:o()(n)})).then(function(t){console.log("异步调用成功返回:"+o()(t)),"success"==t.data.status?(i.close(),e.serviceChargeMsg.dialogVisible=!1,e.getData(),e.$message({type:"success",showClose:!0,duration:3e3,dangerouslyUseHTMLString:!0,message:'<span style="color:black;">服务费修改成功</span>'})):(console.info("服务费修改失败"),i.close(),"请登录认证"===t.data.msg&&e.$router.push({path:"/login"}))},function(t){console.log("异步调用出错:"+o()(t)),i.close(),e.$alert(o()(t.message),"服务费修改失败!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(t){console.log("异步调用失败返回:"+o()(t)),i.close(),e.$alert(o()(t.message),"服务费修改失败!",{confirmButtonText:"确定",callback:function(e){}})});var s=a.map(function(a){return{mbbb_bank_station_uuid:e.customGlobal.userInfoExt.cui_station_id,mbbb_mer_uuid:t,mbbb_device_uuid:a.bma_to_device_uuid,mbbb_fee:a.bank_fee?a.bank_fee:"0"}});this.customGlobal.postHttpClient(this.customGlobal.serverUrl.Reset_equipment_and_rates_update,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:o()(s)})).then(function(e){})},inputChange:function(e,t){e[t]=e[t].replace(/[^\d.]/g,""),e[t]=e[t].replace(/\.{2,}/g,"."),e[t]=e[t].replace(".","$#$").replace(/\./g,"").replace("$#$","."),e[t]=e[t].replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3"),e[t].indexOf(".")<0&&""!=e[t]&&(e[t]=parseFloat(e[t]),e[t]=e[t]+"",e[t].length>2&&(e[t]=e[t].slice(0,2)))},StateManagementChange:function(){var e=this;if(3!=this.StateManagementDate.i||""!=this.textarea){var t=this.StateManagementDate.msg,a=this.StateManagementDate.i,n=this,i={dataList:[{bma_uuid:t.bma_uuid,bma_mer_uuid:t.mbmi_uuid,bma_from_status:"",bma_from_describer:"",bma_to_status:a,bma_to_describer:this.textarea,bma_to_bank_center_id:this.customGlobal.userInfoExt.cui_bank_center_id,bma_to_bank_province_id:this.customGlobal.userInfoExt.cui_province_id,bma_to_bank_city_id:this.customGlobal.userInfoExt.cui_city_id,bma_to_bank_county_id:this.customGlobal.userInfoExt.cui_county_id,bma_to_bank_station_uuid:this.customGlobal.userInfoExt.cui_station_id}]},s=this.$loading({lock:!0,text:"提交中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0)"});this.customGlobal.postHttpClient(this.customGlobal.serverUrl.other_affiliate_outlets_modify_status_update,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:o()(i)})).then(function(t){if("success"==t.data.status){if(s.close(),3==e.StateManagementDate.i)return e.StateManagement.dialogVisible=!1,e.getData(),void e.$message({message:"操作成功",type:"success"});e.Select_shop(),n.StateManagement.tableData=t.data.rows,n.StateManagement.total=t.data.total}else console.info("商户查询失败"),s.close(),"请登录认证"===t.data.msg&&e.$router.push({path:"/login"})},function(t){console.log("异步调用出错:"+o()(t)),s.close(),n.StateManagement.tableData=[],e.$alert(o()(t.message),"商户查询失败!",{confirmButtonText:"确定",callback:function(e){}})}).catch(function(t){console.log("异步调用失败返回:"+o()(t)),s.close(),n.StateManagement.tableData=[],e.$alert(o()(t.message),"商户查询失败！",{confirmButtonText:"确定",callback:function(e){}})})}else this.$message({message:"请输入不通过原因",type:"warning"})},noStateManagementChange:function(e){this.value=e,this.StateManagement.dialogVisible=!0},submitForm:function(){var e=this;this.$confirm("是否进行审核操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.StateManagementDate={msg:e.value,i:3},e.StateManagementChange()}).catch(function(){})},handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})},notApprovedSizeChange:function(e){this.notApproved.perPageSize=e,this.getData()},notApprovedCurrentChange:function(e){this.notApproved.currentPage=e,this.getData()},StateManagementSizeChange:function(e){this.StateManagement.perPageSize=e,this.StateManagementChange()},StateManagementCurrentChange:function(e){this.StateManagement.currentPage=e,this.StateManagementChange()}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[e._m(0),e._v(" "),a("el-table",{ref:"multipleTable",staticClass:"new-table-fixed-right new-table-fixed",attrs:{border:"",data:e.notApproved.tableData,"tooltip-effect":"dark","row-style":{height:"10px"},"cell-style":{padding:"5px 0px"},"header-cell-style":e.headerStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),e._v(" "),e._l(e.notApproved.tableMsg,function(t,n){return a("el-table-column",{key:n,attrs:{prop:t.key,label:t.name},scopedSlots:e._u([{key:"default",fn:function(n){return["设备编号"==t.name?a("span",[e._v(e._s(e._f("format")(n.row[t.key])))]):a("span",[e._v(e._s(n.row[t.key]))])]}}],null,!0)})}),e._v(" "),a("el-table-column",{attrs:{label:"需要开通的业务"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("商品推广")])]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"审核操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.PopupControl(t,e.serviceChargeMsg,t.row,2)}}},[e._v("通过\n        ")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.noStateManagementChange(t.row,2)}}},[e._v("不通过")])]}}])})],2),e._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{background:"","current-page":e.notApproved.currentPage,"page-sizes":[10,20,50,100,200],"page-size":e.notApproved.perPageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.notApproved.total},on:{"size-change":e.notApprovedSizeChange,"current-change":e.notApprovedCurrentChange}}),e._v(" "),a("el-dialog",{attrs:{title:"服务费管理",visible:e.serviceChargeMsg.dialogVisible,width:"80%","before-close":e.handleClose},on:{"update:visible":function(t){return e.$set(e.serviceChargeMsg,"dialogVisible",t)}}},[a("div",[a("div",{staticStyle:{width:"100%","text-align":"left","margin-bottom":"10px"}},[e._v("商户名称："+e._s(e.serviceChargeMsg.name))]),e._v(" "),a("div",{staticStyle:{width:"100%","text-align":"left","margin-bottom":"10px"}},[e._v("收款账号："+e._s(e.serviceChargeMsg.obj.mbmi_mid))]),e._v(" "),a("el-table",{ref:"multipleTable",staticClass:"new-table-fixed-right new-table-fixed",attrs:{border:"",data:e.addQueryList,"tooltip-effect":"dark","row-style":{height:"10px"},"cell-style":{padding:"5px 0px"},"header-cell-style":e.headerStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"bma_to_device_uuid",label:"设备编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("format")(t.row.bma_to_device_uuid)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"平台服务费"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("每笔交易额\n              "),a("el-input",{staticStyle:{width:"150px"},attrs:{disabled:"",value:t.row.mbpb_fee,size:"mini",placeholder:"请输入百分比交易额"}}),e._v("%\n            ")],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"银行服务费"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("每笔交易额\n              "),a("el-input",{staticStyle:{width:"150px"},attrs:{disabled:!t.row.mbmp_partner_uuid||!t.row.mbpb_fee,size:"mini",placeholder:"请输入百分比交易额"},on:{input:function(a){return e.inputChange(t.row,"bank_fee")}},model:{value:t.row.bank_fee,callback:function(a){e.$set(t.row,"bank_fee",a)},expression:"scope.row.bank_fee"}}),e._v("%\n            ")],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"渠道服务费"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("渠道商名称："+e._s(t.row.bmp_name||""))]),e._v(" "),a("div",[e._v("每笔交易额\n              "),a("el-input",{staticStyle:{width:"150px"},attrs:{disabled:"",size:"mini",placeholder:"请输入百分比交易额"},model:{value:t.row.mbmp_fee,callback:function(a){e.$set(t.row,"mbmp_fee",a)},expression:"scope.row.mbmp_fee"}}),e._v("%\n            ")],1)]}}])})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.serviceChargeMsg.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.StateManagementChange()}}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"审核-加盟其他网点申请",visible:e.StateManagement.dialogVisible,width:"50%","before-close":e.handleClose},on:{"update:visible":function(t){return e.$set(e.StateManagement,"dialogVisible",t)}}},[a("span",[a("div",[a("div",{staticStyle:{width:"100%","text-align":"left","margin-bottom":"10px"}},[e._v("请填写审核不通过原因\n        ")]),e._v(" "),a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:e.textarea,callback:function(t){e.textarea=t},expression:"textarea"}})],1)]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.StateManagement.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{display:"flex","justify-content":"space-between",height:"40px"}},[t("div",[this._v("待审核列表")])])}]};var c=a("VU/8")(l,r,!1,function(e){a("breq")},"data-v-7f7d803d",null);t.default=c.exports},breq:function(e,t){}});
//# sourceMappingURL=42.141f8a64323bec452a35.js.map