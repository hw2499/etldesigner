webpackJsonp([79],{EYaH:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=e("fZjL"),l=e.n(o),a=e("BO1k"),r=e.n(a),s=e("mvHQ"),n=e.n(s),d=(e("Wxq9"),e("Vhou"),{name:"OrgInfoBuild",components:{},data:function(){return{companyIds:[],childCompanyIds:[],instituteIds:[],stationIds:[],queryQuarters:[],queryQuarters_s:[],dataCaptions:[],dataQuery:{},treeDataStatus:{},treeData:[],treeDataOptions:[],showTree:!0,tmpCaption:[],buildTypeoptions:[{value:"1",label:"居住建筑"},{value:"2",label:"公共建筑"},{value:"3",label:"混合建筑"}],ballShow:!1,menuLeft:"-180",menuLeft2:"80",menuWidth:"80px",floatDivWidth:70,floatRightValue:"50px",floatTopValue:"55px",tableDialgTitle:"",ballIcon:"el-icon-more",buildDialogFormVisible:!1,buildForm:{bi_uuid:"",bi_company_id:"",bi_company_name:"",bi_child_build_id:"",bi_child_build_name:"",bi_institute_id:"",bi_institute_name:"",bi_station_id:"",bi_station_name:"",bi_community_id:"",bi_community_name:"",bi_build_name:"",bi_build_number:"",bi_longitude:"",bi_latitude:"",bi_build_year:"",bi_build_type:"",bi_unit_count:"",tpui_count:"",bi_memo:"",bi_writetime:"",flag:""},treeNodeInfo:{treeNodeOrgId:"",treeNodeCaptions:""},cardBodyHeight:!0,cardBodyStyle:"padding-top:10px;padding-bottom:10px;",icon1:"el-icon-caret-top",tableData:[],multipleSelection:[],sortOrderCol:"",colsChecked:["bi_build_name","bi_build_number","bi_community_name","tpui_count","bi_unit_count","bi_build_year","bi_build_type","bi_longitude","bi_latitude","bi_memo"],colsMap:[{caption:"楼栋名称",value:"bi_build_name",isShow:!0},{caption:"楼栋位置",value:"bi_build_number",isShow:!0},{caption:"小区名称",value:"bi_community_name",isShow:!0},{caption:"住户数量",value:"tpui_count",isShow:!0},{caption:"单元总数",value:"bi_unit_count",isShow:!0},{caption:"建筑年份",value:"bi_build_year",isShow:!0},{caption:"建筑类型",value:"bi_build_type",isShow:!0},{caption:"经度",value:"bi_longitude",isShow:!0},{caption:"纬度",value:"bi_latitude",isShow:!0},{caption:"备注",value:"bi_memo",isShow:!0}],queryParam:{totalRow:0,currentPage:1,pageSize:this.customGlobal.pageSize},ruleForm:{bi_build_name:"",bi_build_number:""},buildFormRules:{bi_build_name:[{validator:function(t,i,e){0===i.trim().length?e(new Error("楼栋名称不可为空")):e()},trigger:"blur"}],bi_build_number:[{validator:function(t,i,e){0===i.trim().length?e(new Error("楼号不可为空")):e()},trigger:"blur"}]},rules:{}}},mounted:function(){console.info("Mounted_OrgInfoCompany:"+this.pri_detail.treeNodeOrgId),this.getQueryDetail()},created:function(){this.initOrgTemplateInfo(),this.assembleCompanyArray()},props:{pri_detail:{type:Object,default:function(){return{treeNodeCaptions:[],treeNodeIds:[],treeNodeOrgId:"",treeNodeType:[],currentTreeNode:{},cbInfo:{}}}}},watch:{pri_detail:function(t,i){console.info("watch_OrgInfoCompany点击树节点查询【热力公司】新值:"+t.treeNodeOrgId+",旧值："+i.treeNodeOrgId),t.treeNodeOrgId!==i.treeNodeOrgId||t.cbInfo!==i.cbInfo&&(this.dataCaptions=[],""!==this.pri_detail.cbInfo.community.ci_community_name&&(this.dataCaptions[0]=this.pri_detail.cbInfo.community.ci_community_name),this.dataQuery=this.pri_detail.cbInfo),this.cbList(),this.reQueryValveCurrentData()}},directives:{trigger:{inserted:function(t,i){console.log("inserted:"+t.id),"ballBtn"===t.id&&t.click()}},drag:function(t){var i=t,e="";document.onselectstart=function(){return!1},i.onmousedown=function(t){var o=t.clientX-i.offsetLeft,l=t.clientY-i.offsetTop;return document.getElementById("dragbtn").setAttribute("data-flag",!1),document.getElementById("dragbtn").setAttribute("show2",i.offsetLeft),e=(new Date).getTime(),document.onmousemove=function(t){var e=t.clientX-o,a=t.clientY-l;e<=0?e=0:e>=document.documentElement.clientWidth-i.clientWidth&&(e=document.documentElement.clientWidth-i.clientWidth),document.getElementById("dragbtn").setAttribute("show2",e.toString()),a<=0?a=0:a>=document.documentElement.clientHeight-i.clientHeight&&(a=document.documentElement.clientHeight-i.clientHeight),i.style.left=e+"px",i.style.top=a+"px"},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null,(new Date).getTime()-e<200&&document.getElementById("dragbtn").setAttribute("data-flag",!0)},!1}}},methods:{assembleCompanyArray:function(){var t=this.customGlobal.userOrgan,i=JSON.parse(n()(this.customGlobal.permissionKeyOrganKey.orgkey));if("0"!==this.customGlobal.userInfoExt.cui_type||"0"!==this.customGlobal.userInfoExt.cui_org_type){var e=!0,o=!1,a=void 0;try{for(var s,d=r()(l()(i));!(e=(s=d.next()).done);e=!0){var u=s.value;this.selectOrgIds(t,u)}}catch(t){o=!0,a=t}finally{try{!e&&d.return&&d.return()}finally{if(o)throw a}}}else this.selectAdminOrgIds(t)},selectOrgIds:function(t,i){for(var e=0;e<t.length;e++){if(t[e].id===i&&t[e].type>=this.customGlobal.userInfoExt.cui_type)switch(t[e].type){case 1:this.companyIds.push(t[e].id);break;case 2:this.childCompanyIds.push(t[e].id);break;case 3:this.instituteIds.push(t[e].id);break;case 4:this.stationIds.push(t[e].id)}t[e].detail&&this.selectOrgIds(t[e].detail,i)}},selectAdminOrgIds:function(t){for(var i=0;i<t.length;i++){switch(t[i].type){case 1:this.companyIds.push(t[i].id);break;case 2:this.childCompanyIds.push(t[i].id);break;case 3:this.instituteIds.push(t[i].id);break;case 4:this.stationIds.push(t[i].id)}t[i].detail&&this.selectAdminOrgIds(t[i].detail)}},cbList:function(){var t=this;if(void 0!==this.pri_detail.treeNodeType){this.tmpCaption=[];for(var i=0;i<this.pri_detail.treeNodeType.length;i++)this.tmpCaption[i]=this.customGlobal.decrypt(this.pri_detail.treeNodeCaptions[i],this.customGlobal.cryptoKey)}this.$emit("parent_method","",function(i){t.dataQuery=i,"{}"!==n()(t.dataQuery)&&""!==t.dataQuery.community&&""!==t.dataQuery.community.ci_uuid?t.dataCaptions[0]=t.dataQuery.community.ci_community_name:"{}"!==n()(t.dataQuery)&&""===t.dataQuery.community.ci_uuid&&t.dataCaptions.splice(0,1)}),console.info("面包屑"+this.tmpCaption)},getQueryDetail:function(){void 0!==this.pri_detail.treeNodeOrgId?(console.info("点击Tab标签页OrgInfoCompany查询【热力公司】,获取值:"+this.pri_detail.treeNodeOrgId),this.cbList()):console.info("当前没有选择任何组织机构ID，查询所有[热力公司]信息"),this.queryValveCurrentData()},handleChangeQy:function(t){if(this.treeDataOptions.length>1)for(var i=0;i<this.treeDataOptions.length;i++)this.treeDataOptions[i]+",";else this.$alert("请至少选择到热力公司级别","新增提示!",{dangerouslyUseHTMLString:!0})},confCardBodyHeigth:function(){!1===this.cardBodyHeight?(this.cardBodyHeight=!0,this.cardBodyStyle="padding-top:10px;padding-bottom:10px;",this.icon1="el-icon-caret-top"):(this.cardBodyHeight=!1,this.cardBodyStyle="padding-top:0px;padding-bottom:0px;",this.icon1="el-icon-caret-bottom"),console.info("confCardBodyHeigth:"+this.cardBodyHeight)},colCheckCommand:function(){var t=this;console.info("colsChecked："+this.colsChecked),this.colsMap.filter(function(i){console.info("遍历"+i.value),-1!==t.colsChecked.indexOf(i.value)?(console.info("选中集合中存在"+i.value),i.isShow=!0):i.isShow=!1}),console.info("colsList:"+n()(this.colsMap))},reQueryValveCurrentData:function(){this.queryParam.currentPage=1,this.queryValveCurrentData()},queryValveCurrentData:function(){var t=this;console.info("组织机构ID："+this.treeNodeInfo.treeNodeOrgId);var i=this,e="",o="",l="",a="",r="",s="";if(void 0!==this.pri_detail.treeNodeType){var d=this.pri_detail.treeNodeType.length,u=this.pri_detail.treeNodeType[d-1];"1"===u?e=this.pri_detail.treeNodeIds[d-1]:"2"===u?o=this.pri_detail.treeNodeIds[d-1]:"3"===u?l=this.pri_detail.treeNodeIds[d-1]:"4"===u&&(a=this.pri_detail.treeNodeIds[d-1])}void 0!==this.dataQuery.community&&(r=this.dataQuery.community.ci_uuid),void 0!==this.dataQuery.builder&&(s=this.dataQuery.builder.bi_uuid);var c={perPageSize:this.queryParam.pageSize,currentPage:this.queryParam.currentPage,bi_build_name:this.ruleForm.bi_build_name,bi_build_number:this.ruleForm.bi_build_number,bi_company_id:e,bi_child_company_id:o,bi_institute_id:l,bi_station_id:a,bi_community_id:r,bi_build_uuid:s,stationIds:this.stationIds};""!==this.sortOrderCol&&(c.orderby=this.sortOrderCol),this.customGlobal.postHttpClient(this.customGlobal.serverUrl.residentialBuildings_query,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:n()(c)})).then(function(e){console.log("异步调用成功返回:"+n()(e)),"success"==e.data.status?(i.tableData=e.data.rows,i.queryParam.totalRow=e.data.total):(console.info("查询失败"),i.tableData=[],t.$alert(e.data.msg,"查询失败",{confirmButtonText:"确定",callback:function(i){console.info("data:"+n()(e.data)),"请登录认证"===e.data.msg&&"failed"===e.data.status&&t.$router.replace({path:"/login"})}}))},function(e){console.log("异步调用出错:"+n()(e)),i.tableData=[],t.$alert(n()(e.message),"查询出错!",{confirmButtonText:"确定",callback:function(t){}})}).catch(function(e){console.log("异步调用失败返回:"+n()(e)),i.tableData=[],t.$alert(n()(e.message),"查询出错",{confirmButtonText:"确定",callback:function(t){}})})},sortColumn:function(t){console.log("已经排序项："+n()(t));var i="";null!=t.order?("descending"===t.order?i="desc":"ascending"===t.order&&(i="asc"),console.info("属性名称："+t.prop+",排序方式："+t.order),this.sortOrderCol="vci."+t.prop+" "+i,console.info("用户选择排序列："+this.sortOrderCol),this.queryValveCurrentData()):this.sortOrderCol=""},handleSizeChange:function(t){console.log("每页 "+t+" 条"),this.queryParam.pageSize=t,this.queryValveCurrentData()},handleCurrentChange:function(t){console.log("当前页: "+t),this.queryParam.currentPage=t,this.queryValveCurrentData()},handleSelectionChange:function(t){this.multipleSelection=t,console.info("选择的行："+n()(this.multipleSelection))},resetForm:function(t){this.$refs[t].resetFields()},cancelForm:function(t){this.$refs[t].resetFields(),this.$refs[t].clearValidate(),this.buildDialogFormVisible=!1},clearQuery:function(t){this.$refs[t].resetFields()},openBox:function(){if(1!=document.getElementById("dragbtn").getAttribute("data-flag")){"el-icon-more"===this.ballIcon?this.ballIcon="el-icon-right":this.ballIcon="el-icon-more";var t=this.$refs.ballBtn.$el.getBoundingClientRect().x,i=document.documentElement.clientWidth;this.ballShow=!this.ballShow,document.getElementById("buttonMenuBuild").style.left=t>i/2?this.menuLeft+"px":Math.abs(this.menuLeft2)+"px"}},handleAddRow:function(){if(console.log("新增楼栋"),void 0!==this.pri_detail.treeNodeType){var t=this.pri_detail.treeNodeType.length;if("4"===this.pri_detail.treeNodeType[t-1]){var i="";if(void 0!==this.dataQuery.community&&(i=this.dataQuery.community.ci_uuid),""!==i){var e="",o="",l="",a="";"0"!==this.customGlobal.userInfoExt.cui_type?2===this.pri_detail.treeNodeType.length&&"4"===this.pri_detail.treeNodeType[1]?(e=this.pri_detail.treeNodeIds[0],a=this.pri_detail.treeNodeIds[1]):3===this.pri_detail.treeNodeType.length&&"2"===this.pri_detail.treeNodeType[1]&&"4"===this.pri_detail.treeNodeType[2]?(e=this.pri_detail.treeNodeIds[0],o=this.pri_detail.treeNodeIds[1],a=this.pri_detail.treeNodeIds[2]):3===this.pri_detail.treeNodeType.length&&"3"===this.pri_detail.treeNodeType[1]&&"4"===this.pri_detail.treeNodeType[2]?(e=this.pri_detail.treeNodeIds[0],l=this.pri_detail.treeNodeIds[1],a=this.pri_detail.treeNodeIds[2]):(e=this.pri_detail.treeNodeIds[0],o=this.pri_detail.treeNodeIds[1],l=this.pri_detail.treeNodeIds[2],a=this.pri_detail.treeNodeIds[3]):3===this.pri_detail.treeNodeType.length&&"4"===this.pri_detail.treeNodeType[2]?(e=this.pri_detail.treeNodeIds[1],a=this.pri_detail.treeNodeIds[2]):4===this.pri_detail.treeNodeType.length&&"2"===this.pri_detail.treeNodeType[2]&&"4"===this.pri_detail.treeNodeType[3]?(e=this.pri_detail.treeNodeIds[1],o=this.pri_detail.treeNodeIds[2],a=this.pri_detail.treeNodeIds[3]):4===this.pri_detail.treeNodeType.length&&"3"===this.pri_detail.treeNodeType[2]&&"4"===this.pri_detail.treeNodeType[3]?(e=this.pri_detail.treeNodeIds[1],l=this.pri_detail.treeNodeIds[2],a=this.pri_detail.treeNodeIds[3]):(e=this.pri_detail.treeNodeIds[1],o=this.pri_detail.treeNodeIds[2],l=this.pri_detail.treeNodeIds[3],a=this.pri_detail.treeNodeIds[4]),this.getQueryQuarters(a),this.tableDialgTitle="新增楼栋",this.buildForm.bi_company_id=e,this.buildForm.bi_child_company_id=o,this.buildForm.bi_institute_id=l,this.buildForm.bi_station_id=a,this.buildForm.bi_community_id=i,this.treeDataOptions=[],"0"!==this.customGlobal.userInfoExt.cui_type?(this.treeDataOptions[0]=this.buildForm.bi_company_id,""!==this.buildForm.bi_child_company_id&&""!==this.buildForm.bi_institute_id&&""!==this.buildForm.bi_station_id?(this.treeDataOptions[1]=this.buildForm.bi_child_company_id,this.treeDataOptions[2]=this.buildForm.bi_institute_id,this.treeDataOptions[3]=this.buildForm.bi_station_id):""===this.buildForm.bi_child_company_id&&""!==this.buildForm.bi_institute_id&&""!==this.buildForm.bi_station_id?(this.treeDataOptions[1]=this.buildForm.bi_institute_id,this.treeDataOptions[2]=this.buildForm.bi_station_id):""!==this.buildForm.bi_child_company_id&&""===this.buildForm.bi_institute_id&&""!==this.buildForm.bi_station_id?(this.treeDataOptions[1]=this.buildForm.bi_child_company_id,this.treeDataOptions[2]=this.buildForm.bi_station_id):this.treeDataOptions[1]=this.buildForm.bi_station_id):(this.treeDataOptions[0]="0",this.treeDataOptions[1]=this.buildForm.bi_company_id,""!==this.buildForm.bi_child_company_id&&""!==this.buildForm.bi_institute_id&&""!==this.buildForm.bi_station_id?(this.treeDataOptions[2]=this.buildForm.bi_child_company_id,this.treeDataOptions[3]=this.buildForm.bi_institute_id,this.treeDataOptions[4]=this.buildForm.bi_station_id):""===this.buildForm.bi_child_company_id&&""!==this.buildForm.bi_institute_id&&""!==this.buildForm.bi_station_id?(this.treeDataOptions[2]=this.buildForm.bi_institute_id,this.treeDataOptions[3]=this.buildForm.bi_station_id):""!==this.buildForm.bi_child_company_id&&""===this.buildForm.bi_institute_id&&""!==this.buildForm.bi_station_id?(this.treeDataOptions[2]=this.buildForm.bi_child_company_id,this.treeDataOptions[3]=this.buildForm.bi_station_id):this.treeDataOptions[2]=this.buildForm.bi_station_id),this.buildForm.bi_build_name="",this.buildForm.bi_build_number="",this.buildForm.bi_longitude="",this.buildForm.bi_latitude="",this.buildForm.bi_build_year="",this.buildForm.bi_build_type="",this.buildForm.bi_unit_count="",this.buildForm.bi_memo="",this.buildForm.bi_uuid=this.customGlobal.genLogicNo("BI"),this.buildForm.flag="1",this.buildDialogFormVisible=!0}else this.$alert("请选择小区","新增提示",{dangerouslyUseHTMLString:!0})}else this.$alert("请选择小区","新增提示",{dangerouslyUseHTMLString:!0})}else this.$alert("请选择小区","新增提示",{dangerouslyUseHTMLString:!0})},handleEditRow:function(t,i){console.log("修改楼栋"+n()(i)),this.getQueryQuarters(i.bi_station_id),this.tableDialgTitle="修改楼栋 ["+i.bi_build_name+"]",this.buildForm.bi_build_name=i.bi_build_name,this.buildForm.bi_company_id=i.bi_company_id,this.buildForm.bi_child_company_id=i.bi_child_company_id,this.buildForm.bi_institute_id=i.bi_institute_id,this.buildForm.bi_station_id=i.bi_station_id,this.buildForm.bi_community_id=i.bi_community_id,this.buildForm.bi_community_name=i.bi_community_name,this.treeDataOptions=[],"0"!==this.customGlobal.userInfoExt.cui_type?(this.treeDataOptions[0]=this.buildForm.bi_company_id,""!==this.buildForm.bi_child_company_id&&""!==this.buildForm.bi_institute_id&&""!==this.buildForm.bi_station_id?(this.treeDataOptions[1]=this.buildForm.bi_child_company_id,this.treeDataOptions[2]=this.buildForm.bi_institute_id,this.treeDataOptions[3]=this.buildForm.bi_station_id):""===this.buildForm.bi_child_company_id&&""!==this.buildForm.bi_institute_id&&""!==this.buildForm.bi_station_id?(this.treeDataOptions[1]=this.buildForm.bi_institute_id,this.treeDataOptions[2]=this.buildForm.bi_station_id):""!==this.buildForm.bi_child_company_id&&""===this.buildForm.bi_institute_id&&""!==this.buildForm.bi_station_id?(this.treeDataOptions[1]=this.buildForm.bi_child_company_id,this.treeDataOptions[2]=this.buildForm.bi_station_id):this.treeDataOptions[1]=this.buildForm.bi_station_id):(this.treeDataOptions[0]="0",this.treeDataOptions[1]=this.buildForm.bi_company_id,""!==this.buildForm.bi_child_company_id&&""!==this.buildForm.bi_institute_id&&""!==this.buildForm.bi_station_id?(this.treeDataOptions[2]=this.buildForm.bi_child_company_id,this.treeDataOptions[3]=this.buildForm.bi_institute_id,this.treeDataOptions[4]=this.buildForm.bi_station_id):""===this.buildForm.bi_child_company_id&&""!==this.buildForm.bi_institute_id&&""!==this.buildForm.bi_station_id?(this.treeDataOptions[2]=this.buildForm.bi_institute_id,this.treeDataOptions[3]=this.buildForm.bi_station_id):""!==this.buildForm.bi_child_company_id&&""===this.buildForm.bi_institute_id&&""!==this.buildForm.bi_station_id?(this.treeDataOptions[2]=this.buildForm.bi_child_company_id,this.treeDataOptions[3]=this.buildForm.bi_station_id):this.treeDataOptions[2]=this.buildForm.bi_station_id),this.buildForm.bi_build_number=i.bi_build_number,this.buildForm.bi_longitude=i.bi_longitude,this.buildForm.bi_latitude=i.bi_latitude,this.buildForm.bi_build_year=i.bi_build_year,this.buildForm.bi_build_type=i.bi_build_type,this.buildForm.bi_unit_count=i.bi_unit_count,this.buildForm.bi_memo=i.bi_memo,this.buildForm.bi_uuid=i.bi_uuid,this.buildForm.flag="2",this.buildDialogFormVisible=!0},handleDeleteRow:function(t,i){var e=this;console.log("行号："+t+",行内容："+n()(i)),this.buildForm.tpui_count=i.tpui_count,0!==i.tpui_count?this.$alert('当前要删除楼栋[<span style="color:red;font-size: 20px;">'+i.bi_build_number+"</span>]的用户数量不为零，不可以删除","删除提示",{dangerouslyUseHTMLString:!0}):this.$confirm('请再次确认是否要删除[<span style="color:red;">'+i.bi_build_number+"</span>]该行记录?","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0,closeOnClickModal:!1,closeOnPressEscape:!1}).then(function(){var t={bi_uuid:i.bi_uuid};e.customGlobal.postHttpClient(e.customGlobal.serverUrl.residentialBuildings_delete,e.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},e.qs.stringify({jsondata:n()(t)})).then(function(t){console.log("异步调用成功返回:"+n()(t)),"success"==t.data.status?(e.$message({type:"success",showClose:!0,duration:3e3,dangerouslyUseHTMLString:!0,message:'<span style="color:black;">基础信息 ['+i.bi_build_number+"] 删除成功 </span>"}),e.reQueryValveCurrentData()):(console.info("删除失败"),e.$alert(t.data.msg,"删除失败",{confirmButtonText:"确定",callback:function(i){console.info("data:"+n()(t.data)),"请登录认证"===t.data.msg&&e.$router.push({path:"/login"})}}))},function(t){console.log("异步调用出错:"+n()(t)),e.$alert(n()(t.message),"删除出错!",{confirmButtonText:"确定",callback:function(t){}})}).catch(function(t){console.log("异步调用失败返回:"+n()(t)),e.$alert(n()(t.message),"删除出错",{confirmButtonText:"确定",callback:function(t){}})})}).catch(function(t){console.log("取消删除:"+n()(t)),e.$message({type:"info",showClose:!0,duration:3e3,dangerouslyUseHTMLString:!0,message:"已取消删除"})})},getQueryQuarters:function(t){var i=this,e={ci_station_id:t};this.customGlobal.postHttpClient(this.customGlobal.serverUrl.residentialQuarters_query_data,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:n()(e)})).then(function(t){console.log("异步调用成功返回:"+n()(t)),"success"==t.data.status?i.queryQuarters=t.data.rows:(console.info("查询小区列表失败"),i.$alert(t.data.msg,"查询小区列表失败",{confirmButtonText:"确定",callback:function(e){console.info("data:"+n()(t.data)),"请登录认证"===t.data.msg&&i.$router.push({path:"/login"})}}))},function(t){console.log("异步调用出错:"+n()(t)),i.$alert(n()(t.message),"查询小区列表出错!",{confirmButtonText:"确定",callback:function(t){}})}).catch(function(t){console.log("异步调用失败返回:"+n()(t)),i.$alert(n()(t.message),"查询小区列表出错",{confirmButtonText:"确定",callback:function(t){}})})},submitForm:function(t){var i=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;var e=i,o={bi_uuid:e.buildForm.bi_uuid,bi_company_id:e.buildForm.bi_company_id,bi_child_company_id:e.buildForm.bi_child_company_id,bi_institute_id:e.buildForm.bi_institute_id,bi_station_id:e.buildForm.bi_station_id,bi_community_id:e.buildForm.bi_community_id,bi_build_name:e.buildForm.bi_build_name,bi_build_number:e.buildForm.bi_build_number,bi_build_year:e.buildForm.bi_build_year,bi_build_type:e.buildForm.bi_build_type,bi_longitude:e.buildForm.bi_longitude,bi_latitude:e.buildForm.bi_latitude,bi_unit_count:e.buildForm.bi_unit_count,bi_memo:e.buildForm.bi_memo,flag:e.buildForm.flag},l=i.$loading({lock:!0,text:"提交中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0)"});"1"===e.buildForm.flag?(i.customGlobal.postHttpClient(i.customGlobal.serverUrl.residentialBuildings_add,i.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},i.qs.stringify({jsondata:n()(o)})).then(function(t){console.log("异步调用成功返回:"+n()(t)),"success"==t.data.status?(i.buildDialogFormVisible=!1,l.close(),i.$message({type:"success",showClose:!0,duration:3e3,dangerouslyUseHTMLString:!0,message:'<span style="color:black;">基础信息 ['+e.buildForm.bi_build_number+"] 新增成功 </span>"}),i.queryValveCurrentData()):(console.info("新增失败"),l.close(),i.$alert(t.data.msg,"新增失败",{confirmButtonText:"确定",callback:function(e){console.info("data:"+n()(t.data)),"请登录认证"===t.data.msg&&i.$router.push({path:"/login"})}}))},function(t){console.log("异步调用出错:"+n()(t)),l.close(),i.$alert(n()(t.message),"新增出错!",{confirmButtonText:"确定",callback:function(t){}})}).catch(function(t){console.log("异步调用失败返回:"+n()(t)),l.close(),i.$alert(n()(t.message),"新增出错",{confirmButtonText:"确定",callback:function(t){}})}),i.queryValveCurrentData()):(i.customGlobal.postHttpClient(i.customGlobal.serverUrl.residentialBuildings_update,i.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},i.qs.stringify({jsondata:n()(o)})).then(function(t){console.log("异步调用成功返回:"+n()(t)),"success"==t.data.status?(i.buildDialogFormVisible=!1,l.close(),i.$message({type:"success",showClose:!0,duration:3e3,dangerouslyUseHTMLString:!0,message:'<span style="color:black;">基础信息 ['+e.buildForm.bi_build_number+"] 修改成功 </span>"}),i.queryValveCurrentData()):(console.info("修改失败"),l.close(),i.$alert(t.data.msg,"修改失败",{confirmButtonText:"确定",callback:function(e){console.info("data:"+n()(t.data)),"请登录认证"===t.data.msg&&i.$router.push({path:"/login"})}}))},function(t){console.log("异步调用出错:"+n()(t)),l.close(),i.$alert(n()(t.message),"修改出错!",{confirmButtonText:"确定",callback:function(t){}})}).catch(function(t){console.log("异步调用失败返回:"+n()(t)),l.close(),i.$alert(n()(t.message),"修改出错",{confirmButtonText:"确定",callback:function(t){}})}),i.queryValveCurrentData())})},removeTreeNode:function(t,i){var e=t.parent,o=e.data.detail||e.data,l=o.findIndex(function(t){return t.id===i.id});o.splice(l,1)},initTreeDataStatus:function(t,i){var e=i.node,o=i.data;i.store;if("{}"===n()(this.treeDataStatus))return t("span",{style:"font-size:14px;"},[t("span",[o.caption])]);var a=!1,s=!0,d=!1,u=void 0;try{for(var c,b=r()(l()(this.treeDataStatus));!(s=(c=b.next()).done);s=!0){var _=c.value;if(o.id===_)return t("span",[t("span",[o.caption])])}}catch(t){d=!0,u=t}finally{try{!s&&b.return&&b.return()}finally{if(d)throw u}}!1===a&&this.removeTreeNode(e,o)},initOrgTemplateInfo:function(){var t=this,i=this.$loading({lock:!0,text:"查询中...",target:".main",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0)"});this.customGlobal.postHttpClient(this.customGlobal.serverUrl.postQueryOrganTemplate,this.customGlobal.serverUrl.orgBaseURI,{"Content-Type":"application/x-www-form-urlencoded"},this.qs.stringify({jsondata:n()({config:"all",username:this.customGlobal.userInfoExt.cui_login_id})})).then(function(e){console.log("异步调用成功返回:"+n()(e)),"success"==e.data.status?("0"!==t.customGlobal.userInfoExt.cui_type?t.treeData=JSON.parse(e.data.organ).detail:t.treeData=[JSON.parse(e.data.organ)],t.treeDataStatus=JSON.parse(e.data.orgkey),i.close()):(console.info("查询失败"),t.treeData=[JSON.parse(e.data.organ)],t.treeDataStatus=JSON.parse(e.data.orgkey),i.close())},function(e){console.log("异步调用出错:"+n()(e)),i.close(),t.$alert(n()(e.message),"查询出错!",{confirmButtonText:"确定",callback:function(t){}})}).catch(function(e){console.log("异步调用失败返回:"+n()(e)),i.close(),t.$alert(n()(e.message),"查询出错",{confirmButtonText:"确定",callback:function(t){}})})}}}),u={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("el-form",{ref:"ruleForm2",staticClass:"build-formitem",staticStyle:{"text-align":"left","font-size":"20px","font-weight":"bold"},attrs:{"label-position":"left",model:t.ruleForm,rules:t.rules,"label-width":"130px"},nativeOn:{submit:function(t){t.preventDefault()}}},[e("el-card",{staticClass:"build-card1 build-card2",attrs:{shadow:"always","body-style":t.cardBodyStyle}},[e("div",{staticStyle:{"font-size":"14px","font-weight":"bold"},attrs:{slot:"header"},on:{click:t.confCardBodyHeigth},slot:"header"},[e("el-row",{on:{click:t.confCardBodyHeigth}},[e("el-col",{attrs:{md:23}},[e("el-breadcrumb",{staticStyle:{padding:"5px"},attrs:{"separator-class":"el-icon-arrow-right"}},[t._l(this.tmpCaption,function(i,o){return e("el-breadcrumb-item",{key:o},[t._v(t._s(i))])}),t._v(" "),t._l(this.dataCaptions,function(i,o){return e("el-breadcrumb-item",{key:o+"1"},[t._v(t._s(i))])})],2)],1),t._v(" "),e("el-col",{attrs:{md:1},on:{click:t.confCardBodyHeigth}},[e("el-link",{staticStyle:{float:"right","text-decoration":"none","font-size":"20px",height:"10px","line-height":"10px"},attrs:{icon:t.icon1,underline:!1}})],1)],1)],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.cardBodyHeight,expression:"cardBodyHeight"}]},[e("el-row",{attrs:{gutter:24}},[e("el-col",{attrs:{md:12}},[e("el-form-item",{attrs:{label:"楼栋名称",prop:"bi_build_name"}},[e("el-input",{model:{value:t.ruleForm.bi_build_name,callback:function(i){t.$set(t.ruleForm,"bi_build_name",i)},expression:"ruleForm.bi_build_name"}})],1)],1),t._v(" "),e("el-col",{attrs:{md:12}},[e("el-button",{staticStyle:{float:"right","margin-left":"5px"},attrs:{type:"primary"},on:{click:function(i){return t.clearQuery("ruleForm2")}}},[t._v("清空")]),t._v(" "),e("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.queryValveCurrentData}},[t._v("查询")])],1)],1)],1)])],1),t._v(" "),e("el-card",[e("div",{staticStyle:{position:"relative"},attrs:{id:"dragbtn"}},[e("div",{directives:[{name:"drag",rawName:"v-drag"}],style:{width:"62px",right:this.floatRightValue,top:this.floatTopValue,"border-radius":"50%",position:"fixed","padding-left":"0px","padding-top":"8px",cursor:"pointer","z-index":"888"},attrs:{draggable:"false"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.ballShow,expression:"ballShow"}],style:{display:"flex","justify-content":"space-between",position:"absolute",left:this.menuLeft,width:this.menuWidth,top:" 10px"},attrs:{id:"buttonMenuBuild"}},[e("div",{staticStyle:{float:"right","margin-right":"20px"}},[e("el-dropdown",{attrs:{"hide-on-click":!1,_style:"float:right;margin-right: 20px;"}},[e("el-button",{attrs:{type:"primary",size:"small",title:"显示隐藏列"}},[e("i",{staticClass:"el-icon-s-grid "},[t._v("动态列")])]),t._v(" "),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-scrollbar",{staticStyle:{height:"40vh",width:"150px"}},[e("el-checkbox-group",{model:{value:t.colsChecked,callback:function(i){t.colsChecked=i},expression:"colsChecked"}},t._l(t.colsMap,function(i){return e("el-dropdown-item",{key:i.value},[e("el-checkbox",{key:i.value,attrs:{disabled:i.disabled,label:i.value},on:{change:t.colCheckCommand}},[t._v(t._s(i.caption))])],1)}),1)],1)],1)],1)],1),t._v(" "),e("div",{staticStyle:{float:"right","margin-right":"20px"}},[e("el-button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(i){return i.stopPropagation(),t.handleAddRow()}}},[e("i",{staticClass:"el-icon-document-add"},[t._v("新增")])])],1)]),t._v(" "),e("el-tooltip",{attrs:{content:"展开与隐藏功能按钮",placement:"top"}},[e("el-button",{directives:[{name:"trigger",rawName:"v-trigger"}],ref:"ballBtn",class:[!0===t.ballShow?"fadeIn":"fadeOut"],attrs:{id:"ballBtn",type:"primary",icon:this.ballIcon,circle:""},on:{click:function(i){return i.stopPropagation(),i.preventDefault(),t.openBox(i)}}})],1)],1)]),t._v(" "),e("el-table",{ref:"multipleTable",staticClass:"new-table-fixed-right new-table-fixed",attrs:{border:"",data:t.tableData,"tooltip-effect":"dark","row-style":{height:"10px"},"cell-style":{padding:"5px 0px"},"header-cell-style":{background:"#4B86BC",color:"#ffffff",borderRight:"1px solid #E3E5EB",padding:"0px",height:"45px","line-height":"45px"}},on:{"sort-change":t.sortColumn,"selection-change":t.handleSelectionChange}},[t.colsMap[0].isShow?e("el-table-column",{attrs:{fixed:"",prop:"bi_build_name",label:"楼栋名称",align:"center","show-overflow-tooltip":"",width:"100"}}):t._e(),t._v(" "),t.colsMap[1].isShow?e("el-table-column",{attrs:{prop:"bi_build_number",label:"楼栋位置",align:"center","show-overflow-tooltip":"",width:"120"}}):t._e(),t._v(" "),t.colsMap[2].isShow?e("el-table-column",{attrs:{prop:"bi_community_name",label:"小区名称",align:"center","show-overflow-tooltip":"",width:"120"}}):t._e(),t._v(" "),t.colsMap[3].isShow?e("el-table-column",{attrs:{prop:"tpui_count",label:"住户数量",align:"center","show-overflow-tooltip":"",width:"100"},scopedSlots:t._u([{key:"default",fn:function(i){return[0!==i.row.tpui_count?e("el-tag",{attrs:{type:"success",effect:"dark",size:"small"}},[t._v(t._s(i.row.tpui_count))]):e("el-tag",{attrs:{type:"info",effect:"dark",size:"small"}},[t._v(t._s(i.row.tpui_count))])]}}],null,!1,3214270181)}):t._e(),t._v(" "),t.colsMap[4].isShow?e("el-table-column",{attrs:{prop:"bi_unit_count",label:"单元总数",align:"center","show-overflow-tooltip":"",width:"100"}}):t._e(),t._v(" "),t.colsMap[5].isShow?e("el-table-column",{attrs:{prop:"bi_build_year",label:"建筑年份",align:"center","show-overflow-tooltip":"",width:"80"}}):t._e(),t._v(" "),t.colsMap[6].isShow?e("el-table-column",{attrs:{prop:"bi_build_type",label:"建筑类型",align:"center","show-overflow-tooltip":"",width:"80"},scopedSlots:t._u([{key:"default",fn:function(i){return["1"===i.row.bi_build_type?e("el-tag",{attrs:{type:"success",effect:"dark",size:"mini"}},[t._v("居住建筑")]):t._e(),t._v(" "),"2"===i.row.bi_build_type?e("el-tag",{attrs:{type:"success",effect:"dark",size:"mini"}},[t._v("公共建筑")]):t._e(),t._v(" "),"3"===i.row.bi_build_type?e("el-tag",{attrs:{type:"success",effect:"dark",size:"mini"}},[t._v("混合建筑")]):t._e()]}}],null,!1,3590947903)}):t._e(),t._v(" "),t.colsMap[7].isShow?e("el-table-column",{attrs:{prop:"bi_longitude",label:"经度",align:"center","show-overflow-tooltip":"",width:"80"}}):t._e(),t._v(" "),t.colsMap[8].isShow?e("el-table-column",{attrs:{prop:"bi_latitude",label:"纬度",align:"center","show-overflow-tooltip":"",width:"80"}}):t._e(),t._v(" "),t.colsMap[9].isShow?e("el-table-column",{attrs:{prop:"bi_memo",label:"备注",align:"center","show-overflow-tooltip":"",width:"150"}}):t._e(),t._v(" "),e("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-tooltip",{attrs:{content:"编辑",placement:"top"}},[e("el-button",{directives:[{name:"show",rawName:"v-show",value:"00-0"!==i.row.uuid&&"00-1"!==i.row.uuid,expression:"scope.row.uuid!=='00-0' && scope.row.uuid!=='00-1'"}],attrs:{type:"primary",icon:"el-icon-edit",circle:"",size:"mini"},nativeOn:{click:function(e){return e.stopPropagation(),t.handleEditRow(i.$index,i.row)}}})],1),t._v(" "),e("el-tooltip",{attrs:{content:"删除",placement:"top"}},[e("el-button",{directives:[{name:"show",rawName:"v-show",value:"00-0"!==i.row.uuid&&"00-1"!==i.row.uuid,expression:"scope.row.uuid!=='00-0' && scope.row.uuid!=='00-1'"}],attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini"},nativeOn:{click:function(e){return e.stopPropagation(),t.handleDeleteRow(i.$index,i.row)}}})],1)]}}])})],1)],1),t._v(" "),e("el-pagination",{attrs:{background:"","current-page":t.queryParam.currentPage,"page-sizes":[10,20,50,100,200],"page-size":t.queryParam.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.queryParam.totalRow},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t._v(" "),e("el-dialog",{attrs:{visible:t.buildDialogFormVisible,"close-on-press-escape":!1,"close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(i){t.buildDialogFormVisible=i}}},[e("div",{staticStyle:{"text-align":"left","font-size":"20px","font-weight":"bold"},attrs:{slot:"title"},slot:"title"},[e("span",[t._v(t._s(this.tableDialgTitle))])]),t._v(" "),e("el-form",{ref:"buildForm",staticClass:"build-formitem",staticStyle:{"text-align":"left","font-size":"20px","font-weight":"bold"},attrs:{"label-position":"left",model:t.buildForm,rules:t.buildFormRules,"label-width":"130px"}},[e("el-row",{attrs:{gutter:24}},[e("el-col",{attrs:{md:24}},[e("el-form-item",{attrs:{label:"所属组织机构",prop:"bi_company_name",rules:this.buildFormRules.bi_company_name}},[t.showTree?e("el-tree",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"org_tree",attrs:{data:t.treeData,"node-key":"id","highlight-current":"",props:{children:"detail",label:"caption"},"render-content":t.initTreeDataStatus}}):t._e(),t._v(" "),e("el-cascader",{attrs:{id:"el-cascader",options:t.treeData,props:{children:"detail",label:"caption",value:"id",checkStrictly:!0,expandTrigger:"hover"},clearable:"",disabled:""},on:{change:t.handleChangeQy},model:{value:t.treeDataOptions,callback:function(i){t.treeDataOptions=i},expression:"treeDataOptions"}})],1)],1)],1),t._v(" "),e("el-row",{attrs:{gutter:24}},[e("el-col",{attrs:{md:12}},[e("el-form-item",{attrs:{label:"所属小区",prop:"bi_child_company_name"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",filterable:"",disabled:!0},model:{value:t.buildForm.bi_community_id,callback:function(i){t.$set(t.buildForm,"bi_community_id",i)},expression:"buildForm.bi_community_id"}},t._l(t.queryQuarters,function(t){return e("el-option",{key:t.ci_uuid,attrs:{label:t.ci_community_name,value:t.ci_uuid}})}),1)],1)],1),t._v(" "),e("el-col",{attrs:{md:12}},[e("el-form-item",{attrs:{label:"楼栋名称",prop:"bi_build_name",rules:this.buildFormRules.bi_build_name}},[e("el-input",{model:{value:t.buildForm.bi_build_name,callback:function(i){t.$set(t.buildForm,"bi_build_name",i)},expression:"buildForm.bi_build_name"}})],1)],1)],1),t._v(" "),e("el-row",{attrs:{gutter:24}},[e("el-col",{attrs:{md:12}},[e("el-form-item",{attrs:{label:"楼栋位置",prop:"bi_build_number",rules:this.buildFormRules.bi_build_number}},[e("el-input",{model:{value:t.buildForm.bi_build_number,callback:function(i){t.$set(t.buildForm,"bi_build_number",i)},expression:"buildForm.bi_build_number"}})],1)],1),t._v(" "),e("el-col",{attrs:{md:12}},[e("el-form-item",{attrs:{label:"单元总数",prop:"bi_unit_count",rules:this.buildFormRules.bi_unit_count}},[e("el-input",{model:{value:t.buildForm.bi_unit_count,callback:function(i){t.$set(t.buildForm,"bi_unit_count",i)},expression:"buildForm.bi_unit_count"}})],1)],1)],1),t._v(" "),e("el-row",{attrs:{gutter:24}},[e("el-col",{attrs:{md:12}},[e("el-form-item",{attrs:{label:"建筑年份",prop:"bi_build_year",rules:this.buildFormRules.bi_build_year}},[e("el-input",{model:{value:t.buildForm.bi_build_year,callback:function(i){t.$set(t.buildForm,"bi_build_year",i)},expression:"buildForm.bi_build_year"}})],1)],1),t._v(" "),e("el-col",{attrs:{md:12}},[e("el-form-item",{attrs:{label:"建筑类型",prop:"bi_build_type",rules:this.buildFormRules.bi_build_type}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.buildForm.bi_build_type,callback:function(i){t.$set(t.buildForm,"bi_build_type",i)},expression:"buildForm.bi_build_type"}},t._l(t.buildTypeoptions,function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)],1)],1),t._v(" "),e("el-row",{attrs:{gutter:24}},[e("el-col",{attrs:{md:12}},[e("el-form-item",{attrs:{label:"经   度",prop:"bi_longitude",rules:this.buildFormRules.bi_longitude}},[e("el-input",{model:{value:t.buildForm.bi_longitude,callback:function(i){t.$set(t.buildForm,"bi_longitude",i)},expression:"buildForm.bi_longitude"}})],1)],1),t._v(" "),e("el-col",{attrs:{md:12}},[e("el-form-item",{attrs:{label:"纬   度",prop:"bi_latitude",rules:this.buildFormRules.bi_latitude}},[e("el-input",{model:{value:t.buildForm.bi_latitude,callback:function(i){t.$set(t.buildForm,"bi_latitude",i)},expression:"buildForm.bi_latitude"}})],1)],1)],1),t._v(" "),e("el-row",{attrs:{gutter:24}},[e("el-col",{attrs:{md:12}},[e("el-form-item",{attrs:{label:"备注",prop:"bi_memo",rules:this.buildFormRules.bi_memo}},[e("el-input",{attrs:{type:"textarea",rows:2,resize:"none"},model:{value:t.buildForm.bi_memo,callback:function(i){t.$set(t.buildForm,"bi_memo",i)},expression:"buildForm.bi_memo"}})],1)],1)],1)],1),t._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(i){return t.resetForm("buildForm")}}},[t._v("重 置")]),t._v(" "),e("el-button",{on:{click:function(i){return t.cancelForm("buildForm")}}},[t._v("取 消")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:function(i){return t.submitForm("buildForm")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var c=e("VU/8")(d,u,!1,function(t){e("dkM8")},"data-v-05e5a81a",null);i.default=c.exports},dkM8:function(t,i){}});
//# sourceMappingURL=79.29744792dabf91fd240d.js.map